<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>John's Notes</title><link href="http://notes.johnvial.info/" rel="alternate"></link><link href="http://notes.johnvial.info/feeds/all.atom.xml" rel="self"></link><id>http://notes.johnvial.info/</id><updated>2017-06-30T00:00:00+08:00</updated><entry><title>Slumming It - An airbnb review in Sunnyvale, CA</title><link href="http://notes.johnvial.info/slumming-it-an-airbnb-review-in-sunnyvale-ca.html" rel="alternate"></link><published>2017-06-30T00:00:00+08:00</published><updated>2017-06-30T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-30:/slumming-it-an-airbnb-review-in-sunnyvale-ca.html</id><summary type="html">&lt;p&gt;This airbnb is unlike any other I've visited.&lt;/p&gt;
&lt;p&gt;The instructions seemed simple enough, "Your key is in the door, the code is ….". I find myself fumbling with the padlock that is hooked around the front door, the clanging gets the attention of a resident, and they approach the door just …&lt;/p&gt;</summary><content type="html">&lt;p&gt;This airbnb is unlike any other I've visited.&lt;/p&gt;
&lt;p&gt;The instructions seemed simple enough, "Your key is in the door, the code is ….". I find myself fumbling with the padlock that is hooked around the front door, the clanging gets the attention of a resident, and they approach the door just as I get it open. I place my key in my pocket.&lt;/p&gt;
&lt;p&gt;The sunlight illuminates the spartan scene before me. Mattresses line the lounge room floor, the only other furniture being 2 foldable tables and a lonely chair. Luggage and linen cover the other floor surfaces. I inspect the kitchen, only to told by my guide that I'm 'lucky'.&lt;/p&gt;
&lt;p&gt;"Last week", he informs me, "there were twice as many people here, and see that space" he motions to where the dining room table should be, "I slept there last week".
"I just wish people respected the place more, I mean, why should I have to wash up the dirty dishes of everyone else when I want to cook, and nobody has ever cleaned the bathroom!".&lt;/p&gt;
&lt;p&gt;A young indian man, who currently studies at Stanford but is interning with a nearby technology company, grimly informs me that he has found other accommodation, but that this experience has cost him almost $300 USD because the cancellation policy is so bad. I feel for the guy, there is no way I would want to spend 3 months living on a lounge room floor, in what can only be described as a slum!&lt;/p&gt;
&lt;p&gt;I decide to hunt for my room, a '2 person share room with half bathroom in a renovated apartment, bed C-1'. Suddenly I notice the prison like indicators above each bed, D, E and F appear to be lounge room beds, I suddenly hope that the C tag isn't for the other unlabelled bed.&lt;/p&gt;
&lt;p&gt;Thankfully I find a room as described, with the scent of new carpet filling my lungs I plunge into my hospice. Fortunately, only 1 bed exists in this 2 bedroom share room, so I really am living in luxury, and my god, the bed even has sheets and a pillow!&lt;/p&gt;
&lt;p&gt;The next day I get a message from my host "I've overbooked the your room, would you mind moving into the lounge room for tonight?".&lt;/p&gt;
&lt;p&gt;1 - star.&lt;/p&gt;</content></entry><entry><title>Travelling to Santa Cruz</title><link href="http://notes.johnvial.info/travelling-to-santa-cruz.html" rel="alternate"></link><published>2017-06-30T00:00:00+08:00</published><updated>2017-06-30T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-30:/travelling-to-santa-cruz.html</id><summary type="html">&lt;p&gt;Everyone complains about public transport in the Bay Area, but I think that it's actually not that bad.&lt;/p&gt;
&lt;p&gt;I'm writing this from a comfortable, WiFi enabled bus that is taking
me from San Jose to Santa Cruz. I have enough space, get to see a nice
view out of the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Everyone complains about public transport in the Bay Area, but I think that it's actually not that bad.&lt;/p&gt;
&lt;p&gt;I'm writing this from a comfortable, WiFi enabled bus that is taking
me from San Jose to Santa Cruz. I have enough space, get to see a nice
view out of the window, don't have to concentrate on driving and it'll
only take me an hour to get to my destination.&lt;/p&gt;
&lt;p&gt;People often complain about the CalTrain service between San Francisco
and Palo Alto. However, their usual complaint is that it's 1 hour
between services, yet they forget that it's an extremely fast way of
getting around and pretty damn economical. The chairs are also really
large, some of them even have tables and a power outlet. I can't
imagine a more pleasent way of getting around!&lt;/p&gt;
&lt;p&gt;Good on you Bay Area public transport!&lt;/p&gt;</content></entry><entry><title>Draft - Stanford researcher's 4-D Camera's for Underground Mining</title><link href="http://notes.johnvial.info/draft-stanford-researchers-4-d-cameras-for-underground-mining.html" rel="alternate"></link><published>2017-06-29T00:00:00+08:00</published><updated>2017-06-29T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-29:/draft-stanford-researchers-4-d-cameras-for-underground-mining.html</id><summary type="html">&lt;iframe width='500' height='369' src='https://pictures.lytro.com/johnvial/pictures/1247248/embed?enableAttribution=1&amp;enableLogo=1&amp;enableFullscreen=1&amp;enableHelp=1&amp;enablePlay=1' frameborder='0' allowfullscreen scrolling='no'&gt;&lt;/iframe&gt;

&lt;p&gt;(click on Don's face to bring him into focus, you can
also pan around the image)&lt;/p&gt;
&lt;p&gt;During my trip to the bay area I caught up with DD, one of my good
friends from my PhD at the Australian Centre for Field Robotics, Sydney.&lt;/p&gt;
&lt;p&gt;Don's research area is an advanced …&lt;/p&gt;</summary><content type="html">&lt;iframe width='500' height='369' src='https://pictures.lytro.com/johnvial/pictures/1247248/embed?enableAttribution=1&amp;enableLogo=1&amp;enableFullscreen=1&amp;enableHelp=1&amp;enablePlay=1' frameborder='0' allowfullscreen scrolling='no'&gt;&lt;/iframe&gt;

&lt;p&gt;(click on Don's face to bring him into focus, you can
also pan around the image)&lt;/p&gt;
&lt;p&gt;During my trip to the bay area I caught up with DD, one of my good
friends from my PhD at the Australian Centre for Field Robotics, Sydney.&lt;/p&gt;
&lt;p&gt;Don's research area is an advanced type of camera called a light-field.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;"This one camera is like a whole bunch of little cameras all getting a different view of the scene."&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Don thinks this will be critical for the next generation of mining sensors.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;"light fields could let us get a high quality image of a rock face in  low light before it's blasted"&lt;/p&gt;
&lt;p&gt;"light field camera's have no moving parts but can sense depth. They could be more reliable than the lasers currently used on autonomous vehicles"&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;just for kicks, here I am standing where Don was!&lt;/p&gt;
&lt;iframe width='500' height='369' src='https://pictures.lytro.com/johnvial/pictures/1247274/embed?enableAttribution=1&amp;enableLogo=1&amp;enableFullscreen=1&amp;enableHelp=1&amp;enablePlay=1' frameborder='0' allowfullscreen scrolling='no'&gt;&lt;/iframe&gt;</content></entry><entry><title>Good luck Daniel!</title><link href="http://notes.johnvial.info/good-luck-daniel.html" rel="alternate"></link><published>2017-06-21T00:00:00+08:00</published><updated>2017-06-21T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-21:/good-luck-daniel.html</id><summary type="html">&lt;p&gt;Last night the Bay Area public transport system failed me, leaving me
stranded at Millibrae station with only a thin hoodie and a 1 hour
wait for the next CalTrain. So I ordered a Lyft.&lt;/p&gt;
&lt;p&gt;Daniel picked me up and offered me the use of the AUX cable. I showed …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Last night the Bay Area public transport system failed me, leaving me
stranded at Millibrae station with only a thin hoodie and a 1 hour
wait for the next CalTrain. So I ordered a Lyft.&lt;/p&gt;
&lt;p&gt;Daniel picked me up and offered me the use of the AUX cable. I showed
him some songs I enjoy, and showed him my "entrepreneur" soundtrack. I
think the music must've meant something to him because he excitedly
told me his dreams of revolutionising the video blogging industry, and
asked me "but HOW do I start?".&lt;/p&gt;
&lt;p&gt;I gave him my card and said, "email me when you've spoken to 20 video
bloggers about your idea."&lt;/p&gt;
&lt;p&gt;Daniel immediately started making excuses,
"oh, but I have AD&amp;amp;D",
"I struggle to figure out how to execute on all of the ideas I have" and
"I'm not very good at sales" he said.&lt;/p&gt;
&lt;p&gt;To Daniel's credit he took my card and offer anyway.&lt;/p&gt;
&lt;p&gt;Good Luck Daniel! I look forward to hearing from you!&lt;/p&gt;</content></entry><entry><title>Why I give people the EMU</title><link href="http://notes.johnvial.info/why-i-give-people-the-emu.html" rel="alternate"></link><published>2017-06-21T00:00:00+08:00</published><updated>2017-06-21T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-21:/why-i-give-people-the-emu.html</id><summary type="html">&lt;p&gt;&lt;img alt="Emu Business Card" src="/images/emu.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Until I get some &lt;a href="http://soundelve.com"&gt;SOUNDelve&lt;/a&gt; cards made up I'm
going to be giving out my EMU cards.&lt;/p&gt;
&lt;p&gt;I just wanted to let you know that if you've got one of these, you
have something that is quite special to me. The EMU logo, is the logo
I made for my …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;img alt="Emu Business Card" src="/images/emu.jpg"&gt;&lt;/p&gt;
&lt;p&gt;Until I get some &lt;a href="http://soundelve.com"&gt;SOUNDelve&lt;/a&gt; cards made up I'm
going to be giving out my EMU cards.&lt;/p&gt;
&lt;p&gt;I just wanted to let you know that if you've got one of these, you
have something that is quite special to me. The EMU logo, is the logo
I made for my first ever startup venture, a failed headphone importing
business named emurunning.&lt;/p&gt;
&lt;p&gt;I made alot of mistakes with Emurunning. I bought 100 headphones from
China before I knew that could actually sell them! I also entered a
market where my hard-earned skills were completely useless, that is,
there was no way I could add value to the product by using my robotics
background. Ultimately, it was a play in marketing, and truly I sold
an overpriced product.&lt;/p&gt;
&lt;p&gt;I did get some sales though, and I think I did deliver the $60 worth
of value I had charged. I even experienced the ire of the internet when I
posted it on a local deals website.&lt;/p&gt;
&lt;p&gt;Even though I quit that business, I proudly use its logo. It's a cool
Emu, made for $50 from an artist in Sri-Lanka for me, and it
represents my first step of this entrepreneurial journey I have
started.&lt;/p&gt;</content></entry><entry><title>Starbucks Palo ALto</title><link href="http://notes.johnvial.info/starbucks-palo-alto.html" rel="alternate"></link><published>2017-06-15T00:00:00+08:00</published><updated>2017-06-15T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-15:/starbucks-palo-alto.html</id><summary type="html">&lt;p&gt;So I've decided that Starbucks is now my go-to coffee place. The
coffee is poor, but cheap compared to other shops, and the internet is
reliably good and fast. What I didn't expect was to sit down and start
overhearing more conversations:&lt;/p&gt;
&lt;p&gt;Across from me, a man and a lady …&lt;/p&gt;</summary><content type="html">&lt;p&gt;So I've decided that Starbucks is now my go-to coffee place. The
coffee is poor, but cheap compared to other shops, and the internet is
reliably good and fast. What I didn't expect was to sit down and start
overhearing more conversations:&lt;/p&gt;
&lt;p&gt;Across from me, a man and a lady appear to be discussing VC
investments.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We've got to make sure the value proposition fits for us. We usually
invest in funds that have already raised atleast 1.5 or 2 million.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Eventually the pair conclude their meeting and leave, their rubbish
still on the table. Two minutes later an unkempt man swaggers into the
seating area and lifts up their empty coffee cup with a look of
disappointment. He then slaps their empty food bag, and realising it
contains half a roll, quickly grabs it and starts eating. He casually
surveys the area, gathers up some newspapers strewn on a nearby table,
and then calmly walks out as he chews on his prize.&lt;/p&gt;
&lt;p&gt;Minutes later a woman walks in off the street, looks at the empty
coffee cup and puts it in the nearby bin. She then walks back out to
continue her journey.&lt;/p&gt;
&lt;p&gt;During all of this a teenager explains to his younger brother the intricacies
of playing the Pokemon card game.&lt;/p&gt;</content></entry><entry><title>Fisheries Competition - Adding Bounding Box's</title><link href="http://notes.johnvial.info/fisheries-part2.html" rel="alternate"></link><published>2017-06-12T00:00:00+08:00</published><updated>2017-06-12T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-12:/fisheries-part2.html</id><summary type="html">&lt;p&gt;As part of the homework for lesson 7 of the fast.ai course, let's use the bounding box information to achieve a better score on the fisheries competition.&lt;/p&gt;</summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="First,-lets-explore-the-fisheries-data"&gt;First, lets explore the fisheries data&lt;a class="anchor-link" href="#First,-lets-explore-the-fisheries-data"&gt;Â¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;keras&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.models&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Model&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.layers&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Dense&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;InputLayer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Input&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Flatten&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;MaxPooling2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GlobalMaxPool2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GlobalAveragePooling2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.preprocessing.image&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ImageDataGenerator&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.layers.core&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Activation&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;PIL.Image&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;move&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;split&lt;/span&gt;
&lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;classes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;Using TensorFlow backend.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[1]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['.DS_Store', 'ALB', 'BET', 'DOL', 'LAG', 'NoF', 'OTHER', 'SHARK', 'YFT']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;boxes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'./data/boxes/'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;boxes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[4]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['alb_labels.json',
 'bet_labels.json',
 'dol_labels.json',
 'lag_labels.json',
 'NoF_labels.json',
 'other_labels.json',
 'shark_labels.json']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;classes&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;'.'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;classes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[5]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['ALB', 'BET', 'DOL', 'LAG', 'NoF', 'OTHER', 'SHARK', 'YFT']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.random&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;choice&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;glob&lt;/span&gt;

&lt;span class="n"&gt;valid_ratio&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.2&lt;/span&gt;
&lt;span class="n"&gt;num_sample_images&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
&lt;span class="n"&gt;valid_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;valid_path&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;valid_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;classes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;cl_valid_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;valid_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;cl_train_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;cl_sample_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_train_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'*.jpg'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_valid_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;valid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;))),&lt;/span&gt; &lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_valid_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;valid&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="c1"&gt;# We don't want the sample to contain the validation data, so redo the glob after moving. &lt;/span&gt;
        &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_train_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'*.jpg'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_sample_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_sample_images&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_sample_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ImageDataGenerator&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;train_gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flow_from_directory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;valid_gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flow_from_directory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sample_gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flow_from_directory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Found 3025 images belonging to 8 classes.
Found 752 images belonging to 8 classes.
Found 80 images belonging to 8 classes.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;bcolz&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tqdm&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;save_generator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;span class="sd"&gt;    Save the output from a generator without loading all images into memory. &lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Does not return anything, instead writes data to disk.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    :gen: A Keras ImageDataGenerator object&lt;/span&gt;
&lt;span class="sd"&gt;    :data_dir: The folder name to store the bcolz array representing the features in. &lt;/span&gt;
&lt;span class="sd"&gt;    :labels_dir: The folder name to store the bcolz array representing the labels in.&lt;/span&gt;
&lt;span class="sd"&gt;    :mode: the write mode. Set to 'a' for append, set to 'w' to overwrite existing data and 'r' to read only. &lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    
    &lt;span class="n"&gt;num_samples&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;
    
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__next__&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__next__&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="n"&gt;trn_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;trn_label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'label'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'label'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;samp_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;samp_label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'label'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;#save_generator(train_gen, trn_data, trn_label)&lt;/span&gt;
&lt;span class="c1"&gt;#save_generator(valid_gen, val_data, val_label)&lt;/span&gt;
&lt;span class="c1"&gt;#save_generator(sample_gen, samp_data, samp_label)&lt;/span&gt;

&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trn_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trn_label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val_label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;
&lt;span class="n"&gt;boxes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['alb_labels.json',
 'bet_labels.json',
 'dol_labels.json',
 'lag_labels.json',
 'NoF_labels.json',
 'other_labels.json',
 'shark_labels.json']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;findall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'[a-zA-Z]*'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;boxes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['alb', '', 'labels', '', 'json', '']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;To convert the coordinates to our resized size we will need to know the original image size.&lt;/p&gt;
&lt;p&gt;Note: If you are running windows you will want to split on '\' instead of '/'&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [24]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;train_sizes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;PIL&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;train_gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filenames&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;valid_sizes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;PIL&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;valid_gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filenames&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;sample_sizes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;PIL&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sample_gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filenames&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [25]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;all_sizes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;all_sizes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;train_sizes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;valid_sizes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sample_sizes&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;span class="n"&gt;all_sizes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[25]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'img_03675.jpg': (1280, 974),
 'img_02591.jpg': (1280, 750),
 'img_05880.jpg': (1276, 718),
 'img_05281.jpg': (1280, 720),
 'img_05758.jpg': (1192, 670),
 'img_06724.jpg': (1280, 974),
 'img_01942.jpg': (1280, 720),
 'img_04093.jpg': (1280, 720),
 'img_02910.jpg': (1280, 750),
 'img_03081.jpg': (1280, 720),
 'img_05762.jpg': (1280, 974),
 'img_06048.jpg': (1280, 720),
 'img_06284.jpg': (1280, 750),
 'img_01757.jpg': (1280, 720),
 'img_04158.jpg': (1280, 974),
 'img_00143.jpg': (1280, 720),
 'img_06112.jpg': (1280, 750),
 'img_05065.jpg': (1280, 720),
 'img_01660.jpg': (1192, 670),
 'img_01000.jpg': (1280, 720),
 'img_00756.jpg': (1280, 720),
 'img_02758.jpg': (1280, 720),
 'img_00866.jpg': (1280, 720),
 'img_04693.jpg': (1280, 720),
 'img_01246.jpg': (1280, 720),
 'img_02875.jpg': (1192, 670),
 'img_07239.jpg': (1280, 720),
 'img_05511.jpg': (1276, 718),
 'img_00191.jpg': (1280, 720),
 'img_02348.jpg': (1280, 720),
 'img_04644.jpg': (1280, 750),
 'img_07227.jpg': (1280, 720),
 'img_02468.jpg': (1192, 670),
 'img_07712.jpg': (1280, 720),
 'img_07608.jpg': (1280, 750),
 'img_07545.jpg': (1280, 750),
 'img_06116.jpg': (1518, 854),
 'img_01934.jpg': (1280, 720),
 'img_02418.jpg': (1276, 718),
 'img_07435.jpg': (1280, 720),
 'img_07114.jpg': (1280, 720),
 'img_03710.jpg': (1280, 720),
 'img_02138.jpg': (1280, 720),
 'img_00911.jpg': (1280, 720),
 'img_04633.jpg': (1280, 720),
 'img_00788.jpg': (1280, 720),
 'img_05827.jpg': (1280, 720),
 'img_01464.jpg': (1280, 720),
 'img_01307.jpg': (1280, 974),
 'img_07077.jpg': (1280, 720),
 'img_02431.jpg': (1280, 720),
 'img_00531.jpg': (1280, 974),
 'img_06826.jpg': (1280, 720),
 'img_02689.jpg': (1280, 750),
 'img_00348.jpg': (1280, 750),
 'img_07240.jpg': (1280, 720),
 'img_02491.jpg': (1280, 720),
 'img_06578.jpg': (1280, 720),
 'img_00624.jpg': (1280, 720),
 'img_03505.jpg': (1280, 750),
 'img_01400.jpg': (1280, 720),
 'img_05886.jpg': (1280, 750),
 'img_07557.jpg': (1280, 720),
 'img_07649.jpg': (1280, 720),
 'img_01973.jpg': (1280, 720),
 'img_04463.jpg': (1280, 720),
 'img_01772.jpg': (1280, 720),
 'img_05535.jpg': (1280, 720),
 'img_01833.jpg': (1280, 720),
 'img_06152.jpg': (1280, 974),
 'img_01241.jpg': (1280, 750),
 'img_02737.jpg': (1280, 750),
 'img_01558.jpg': (1280, 720),
 'img_00831.jpg': (1280, 720),
 'img_05315.jpg': (1280, 750),
 'img_04336.jpg': (1280, 720),
 'img_07221.jpg': (1280, 720),
 'img_07275.jpg': (1280, 720),
 'img_01817.jpg': (1280, 720),
 'img_03022.jpg': (1280, 720),
 'img_04542.jpg': (1280, 750),
 'img_03453.jpg': (1280, 720),
 'img_07710.jpg': (1280, 720),
 'img_05112.jpg': (1280, 720),
 'img_01993.jpg': (1280, 720),
 'img_02128.jpg': (1280, 720),
 'img_06307.jpg': (1280, 750),
 'img_01916.jpg': (1280, 750),
 'img_01201.jpg': (1280, 720),
 'img_01654.jpg': (1280, 720),
 'img_00038.jpg': (1280, 720),
 'img_02283.jpg': (1280, 720),
 'img_07728.jpg': (1280, 974),
 'img_06063.jpg': (1280, 720),
 'img_03244.jpg': (1280, 720),
 'img_07365.jpg': (1280, 720),
 'img_01497.jpg': (1280, 720),
 'img_00558.jpg': (1280, 720),
 'img_05902.jpg': (1192, 670),
 'img_07429.jpg': (1280, 974),
 'img_06092.jpg': (1280, 720),
 'img_04806.jpg': (1280, 750),
 'img_06960.jpg': (1280, 720),
 'img_06714.jpg': (1280, 720),
 'img_05557.jpg': (1280, 720),
 'img_00165.jpg': (1280, 720),
 'img_03535.jpg': (1280, 720),
 'img_01422.jpg': (1280, 720),
 'img_04352.jpg': (1280, 720),
 'img_02034.jpg': (1276, 718),
 'img_05097.jpg': (1280, 720),
 'img_03997.jpg': (1280, 720),
 'img_01335.jpg': (1280, 974),
 'img_03480.jpg': (1280, 720),
 'img_02825.jpg': (1280, 720),
 'img_02301.jpg': (1280, 750),
 'img_01276.jpg': (1280, 720),
 'img_00725.jpg': (1280, 720),
 'img_01086.jpg': (1280, 720),
 'img_00352.jpg': (1280, 974),
 'img_01135.jpg': (1280, 720),
 'img_01160.jpg': (1280, 720),
 'img_01514.jpg': (1192, 670),
 'img_04756.jpg': (1280, 974),
 'img_02386.jpg': (1192, 670),
 'img_03246.jpg': (1280, 720),
 'img_04875.jpg': (1280, 720),
 'img_03278.jpg': (1280, 720),
 'img_07850.jpg': (1280, 720),
 'img_02364.jpg': (1244, 700),
 'img_05716.jpg': (1280, 750),
 'img_03025.jpg': (1280, 720),
 'img_07287.jpg': (1280, 974),
 'img_01333.jpg': (1280, 750),
 'img_01560.jpg': (1280, 720),
 'img_04873.jpg': (1280, 720),
 'img_00337.jpg': (1280, 720),
 'img_05783.jpg': (1280, 720),
 'img_07204.jpg': (1280, 720),
 'img_02324.jpg': (1280, 750),
 'img_02595.jpg': (1280, 720),
 'img_06672.jpg': (1280, 974),
 'img_01163.jpg': (1280, 750),
 'img_06591.jpg': (1280, 750),
 'img_01264.jpg': (1280, 720),
 'img_02053.jpg': (1280, 720),
 'img_01835.jpg': (1280, 974),
 'img_00881.jpg': (1276, 718),
 'img_04009.jpg': (1280, 720),
 'img_06821.jpg': (1280, 720),
 'img_07134.jpg': (1280, 750),
 'img_07168.jpg': (1280, 720),
 'img_01628.jpg': (1280, 974),
 'img_06719.jpg': (1280, 720),
 'img_06386.jpg': (1280, 720),
 'img_00055.jpg': (1280, 750),
 'img_00261.jpg': (1280, 720),
 'img_07530.jpg': (1280, 720),
 'img_07729.jpg': (1280, 720),
 'img_04229.jpg': (1280, 750),
 'img_03917.jpg': (1280, 720),
 'img_06656.jpg': (1280, 750),
 'img_02463.jpg': (1280, 720),
 'img_04967.jpg': (1280, 720),
 'img_05190.jpg': (1276, 718),
 'img_01806.jpg': (1280, 720),
 'img_03938.jpg': (1280, 750),
 'img_02530.jpg': (1280, 720),
 'img_07633.jpg': (1280, 974),
 'img_07518.jpg': (1280, 974),
 'img_07847.jpg': (1192, 670),
 'img_03979.jpg': (1280, 720),
 'img_03560.jpg': (1280, 720),
 'img_04231.jpg': (1280, 720),
 'img_05550.jpg': (1280, 750),
 'img_07397.jpg': (1280, 720),
 'img_02151.jpg': (1276, 718),
 'img_06443.jpg': (1280, 750),
 'img_05680.jpg': (1280, 720),
 'img_03374.jpg': (1280, 720),
 'img_07775.jpg': (1280, 720),
 'img_07017.jpg': (1280, 750),
 'img_07252.jpg': (1280, 750),
 'img_04052.jpg': (1518, 854),
 'img_05745.jpg': (1280, 720),
 'img_00391.jpg': (1280, 974),
 'img_07282.jpg': (1280, 720),
 'img_00696.jpg': (1280, 750),
 'img_04022.jpg': (1280, 720),
 'img_05022.jpg': (1280, 720),
 'img_03787.jpg': (1280, 974),
 'img_00295.jpg': (1280, 750),
 'img_02534.jpg': (1280, 750),
 'img_01820.jpg': (1280, 720),
 'img_01485.jpg': (1280, 720),
 'img_01143.jpg': (1280, 720),
 'img_02562.jpg': (1280, 720),
 'img_00237.jpg': (1192, 670),
 'img_02710.jpg': (1280, 720),
 'img_03585.jpg': (1280, 750),
 'img_02505.jpg': (1280, 974),
 'img_00321.jpg': (1280, 974),
 'img_04779.jpg': (1280, 720),
 'img_03154.jpg': (1280, 720),
 'img_05494.jpg': (1280, 720),
 'img_06996.jpg': (1732, 974),
 'img_01482.jpg': (1280, 720),
 'img_02745.jpg': (1280, 720),
 'img_04501.jpg': (1244, 700),
 'img_04154.jpg': (1280, 720),
 'img_01265.jpg': (1280, 720),
 'img_06069.jpg': (1280, 720),
 'img_05868.jpg': (1280, 750),
 'img_06323.jpg': (1244, 700),
 'img_05892.jpg': (1280, 720),
 'img_03714.jpg': (1280, 720),
 'img_02185.jpg': (1280, 720),
 'img_07109.jpg': (1280, 750),
 'img_00715.jpg': (1280, 720),
 'img_01064.jpg': (1280, 974),
 'img_03336.jpg': (1732, 974),
 'img_02018.jpg': (1280, 924),
 'img_02025.jpg': (1280, 720),
 'img_06532.jpg': (1280, 720),
 'img_05239.jpg': (1280, 720),
 'img_07197.jpg': (1280, 720),
 'img_07533.jpg': (1280, 720),
 'img_04854.jpg': (1280, 720),
 'img_01185.jpg': (1280, 720),
 'img_03918.jpg': (1280, 974),
 'img_07567.jpg': (1280, 750),
 'img_02112.jpg': (1192, 670),
 'img_06006.jpg': (1280, 974),
 'img_07544.jpg': (1244, 700),
 'img_03343.jpg': (1280, 750),
 'img_00678.jpg': (1280, 720),
 'img_02958.jpg': (1280, 750),
 'img_07228.jpg': (1192, 670),
 'img_01766.jpg': (1280, 720),
 'img_00299.jpg': (1280, 720),
 'img_05800.jpg': (1732, 974),
 'img_02399.jpg': (1280, 750),
 'img_06467.jpg': (1280, 720),
 'img_02633.jpg': (1280, 720),
 'img_07747.jpg': (1280, 924),
 'img_07898.jpg': (1280, 720),
 'img_03067.jpg': (1280, 720),
 'img_06523.jpg': (1280, 720),
 'img_07773.jpg': (1280, 750),
 'img_02113.jpg': (1276, 718),
 'img_01615.jpg': (1280, 974),
 'img_05973.jpg': (1280, 720),
 'img_06404.jpg': (1280, 974),
 'img_03253.jpg': (1280, 720),
 'img_07826.jpg': (1280, 750),
 'img_03893.jpg': (1280, 720),
 'img_00869.jpg': (1280, 720),
 'img_02635.jpg': (1280, 720),
 'img_01927.jpg': (1280, 720),
 'img_04605.jpg': (1732, 974),
 'img_05890.jpg': (1280, 720),
 'img_02997.jpg': (1732, 974),
 'img_06610.jpg': (1280, 720),
 'img_06847.jpg': (1280, 974),
 'img_04309.jpg': (1280, 720),
 'img_03051.jpg': (1280, 974),
 'img_07767.jpg': (1280, 720),
 'img_03817.jpg': (1280, 974),
 'img_01796.jpg': (1280, 720),
 'img_02433.jpg': (1276, 718),
 'img_06200.jpg': (1280, 750),
 'img_00848.jpg': (1280, 974),
 'img_02816.jpg': (1280, 750),
 'img_07268.jpg': (1280, 750),
 'img_00105.jpg': (1280, 720),
 'img_04880.jpg': (1280, 720),
 'img_02254.jpg': (1280, 720),
 'img_04678.jpg': (1280, 720),
 'img_06156.jpg': (1280, 720),
 'img_07547.jpg': (1280, 720),
 'img_06471.jpg': (1280, 720),
 'img_05645.jpg': (1280, 974),
 'img_01255.jpg': (1280, 720),
 'img_01841.jpg': (1280, 720),
 'img_01193.jpg': (1732, 974),
 'img_05375.jpg': (1280, 720),
 'img_02630.jpg': (1280, 720),
 'img_01763.jpg': (1280, 750),
 'img_06204.jpg': (1280, 720),
 'img_07390.jpg': (1280, 974),
 'img_05641.jpg': (1192, 670),
 'img_06057.jpg': (1276, 718),
 'img_00997.jpg': (1280, 750),
 'img_00819.jpg': (1280, 750),
 'img_07344.jpg': (1280, 974),
 'img_00278.jpg': (1280, 720),
 'img_06142.jpg': (1280, 720),
 'img_07749.jpg': (1280, 720),
 'img_01822.jpg': (1280, 720),
 'img_04090.jpg': (1280, 924),
 'img_01003.jpg': (1280, 974),
 'img_04471.jpg': (1192, 670),
 'img_00888.jpg': (1192, 670),
 'img_05689.jpg': (1280, 750),
 'img_03908.jpg': (1518, 854),
 'img_07223.jpg': (1280, 720),
 'img_02727.jpg': (1280, 720),
 'img_06134.jpg': (1280, 720),
 'img_04927.jpg': (1280, 974),
 'img_05490.jpg': (1280, 720),
 'img_02343.jpg': (1280, 974),
 'img_02017.jpg': (1280, 750),
 'img_05332.jpg': (1192, 670),
 'img_01677.jpg': (1732, 974),
 'img_06566.jpg': (1280, 720),
 'img_06421.jpg': (1280, 750),
 'img_04139.jpg': (1732, 974),
 'img_05553.jpg': (1280, 974),
 'img_05658.jpg': (1280, 974),
 'img_01291.jpg': (1280, 974),
 'img_00494.jpg': (1280, 720),
 'img_02940.jpg': (1280, 750),
 'img_02946.jpg': (1280, 720),
 'img_04249.jpg': (1280, 720),
 'img_05472.jpg': (1280, 720),
 'img_01233.jpg': (1280, 720),
 'img_04851.jpg': (1280, 720),
 'img_02698.jpg': (1280, 720),
 'img_02765.jpg': (1280, 720),
 'img_02976.jpg': (1280, 974),
 'img_04495.jpg': (1280, 720),
 'img_01165.jpg': (1334, 750),
 'img_01390.jpg': (1280, 720),
 'img_01011.jpg': (1280, 720),
 'img_00158.jpg': (1280, 720),
 'img_07558.jpg': (1280, 720),
 'img_01396.jpg': (1280, 720),
 'img_03713.jpg': (1280, 720),
 'img_05227.jpg': (1192, 670),
 'img_00481.jpg': (1192, 670),
 'img_01029.jpg': (1280, 720),
 'img_02446.jpg': (1280, 720),
 'img_05408.jpg': (1280, 720),
 'img_00014.jpg': (1280, 974),
 'img_02728.jpg': (1280, 720),
 'img_01578.jpg': (1280, 720),
 'img_04837.jpg': (1280, 974),
 'img_03451.jpg': (1280, 720),
 'img_00803.jpg': (1280, 974),
 'img_00546.jpg': (1276, 718),
 'img_04968.jpg': (1192, 670),
 'img_03842.jpg': (1280, 720),
 'img_01890.jpg': (1276, 718),
 'img_03356.jpg': (1280, 720),
 'img_06334.jpg': (1280, 974),
 'img_06493.jpg': (1280, 720),
 'img_01433.jpg': (1276, 718),
 'img_00406.jpg': (1732, 974),
 'img_06114.jpg': (1192, 670),
 'img_06338.jpg': (1280, 974),
 'img_07500.jpg': (1280, 720),
 'img_04578.jpg': (1280, 720),
 'img_00178.jpg': (1280, 720),
 'img_02341.jpg': (1280, 750),
 'img_01306.jpg': (1276, 718),
 'img_04524.jpg': (1280, 720),
 'img_04026.jpg': (1280, 720),
 'img_01601.jpg': (1280, 750),
 'img_01076.jpg': (1280, 974),
 'img_01721.jpg': (1280, 974),
 'img_02643.jpg': (1280, 720),
 'img_05094.jpg': (1280, 720),
 'img_02456.jpg': (1280, 720),
 'img_00397.jpg': (1280, 720),
 'img_04373.jpg': (1280, 974),
 'img_06503.jpg': (1280, 720),
 'img_04627.jpg': (1280, 750),
 'img_05373.jpg': (1280, 924),
 'img_04083.jpg': (1280, 974),
 'img_01603.jpg': (1280, 750),
 'img_02439.jpg': (1280, 720),
 'img_01087.jpg': (1280, 974),
 'img_03090.jpg': (1280, 720),
 'img_07923.jpg': (1280, 720),
 'img_06252.jpg': (1280, 720),
 'img_02186.jpg': (1280, 720),
 'img_07200.jpg': (1280, 720),
 'img_00984.jpg': (1280, 720),
 'img_00993.jpg': (1280, 750),
 'img_03984.jpg': (1280, 974),
 'img_04544.jpg': (1280, 720),
 'img_05116.jpg': (1280, 750),
 'img_04952.jpg': (1280, 720),
 'img_00197.jpg': (1280, 720),
 'img_00032.jpg': (1192, 670),
 'img_06260.jpg': (1280, 720),
 'img_00482.jpg': (1280, 720),
 'img_00545.jpg': (1280, 720),
 'img_01686.jpg': (1280, 720),
 'img_00998.jpg': (1280, 750),
 'img_01812.jpg': (1280, 720),
 'img_00653.jpg': (1280, 924),
 'img_04583.jpg': (1280, 720),
 'img_03755.jpg': (1280, 720),
 'img_03612.jpg': (1280, 720),
 'img_06537.jpg': (1280, 720),
 'img_06226.jpg': (1280, 974),
 'img_07657.jpg': (1280, 720),
 'img_05275.jpg': (1280, 720),
 'img_05592.jpg': (1280, 974),
 'img_02492.jpg': (1280, 750),
 'img_04289.jpg': (1280, 974),
 'img_06014.jpg': (1280, 720),
 'img_04150.jpg': (1280, 750),
 'img_05637.jpg': (1280, 924),
 'img_06695.jpg': (1280, 750),
 'img_02621.jpg': (1280, 750),
 'img_01744.jpg': (1276, 718),
 'img_06299.jpg': (1280, 974),
 'img_05560.jpg': (1280, 720),
 'img_05075.jpg': (1192, 670),
 'img_06589.jpg': (1276, 718),
 'img_02858.jpg': (1280, 720),
 'img_02377.jpg': (1280, 720),
 'img_06374.jpg': (1280, 750),
 'img_05480.jpg': (1280, 750),
 'img_03479.jpg': (1280, 720),
 'img_02499.jpg': (1280, 720),
 'img_05810.jpg': (1280, 720),
 'img_02605.jpg': (1280, 750),
 'img_02378.jpg': (1280, 750),
 'img_04041.jpg': (1280, 750),
 'img_00201.jpg': (1192, 670),
 'img_05249.jpg': (1280, 974),
 'img_00574.jpg': (1280, 720),
 'img_01707.jpg': (1280, 974),
 'img_06929.jpg': (1280, 720),
 'img_01455.jpg': (1280, 720),
 'img_06228.jpg': (1280, 720),
 'img_02981.jpg': (1280, 974),
 'img_02642.jpg': (1280, 974),
 'img_04032.jpg': (1280, 720),
 'img_03700.jpg': (1280, 720),
 'img_01093.jpg': (1280, 720),
 'img_07334.jpg': (1280, 720),
 'img_01083.jpg': (1280, 720),
 'img_00428.jpg': (1280, 720),
 'img_03544.jpg': (1280, 974),
 'img_02272.jpg': (1280, 720),
 'img_04848.jpg': (1192, 670),
 'img_05347.jpg': (1280, 720),
 'img_01767.jpg': (1280, 720),
 'img_03887.jpg': (1276, 718),
 'img_02201.jpg': (1280, 720),
 'img_06081.jpg': (1280, 720),
 'img_00713.jpg': (1280, 720),
 'img_01992.jpg': (1280, 750),
 'img_06428.jpg': (1280, 720),
 'img_03376.jpg': (1280, 720),
 'img_05310.jpg': (1280, 720),
 'img_06935.jpg': (1192, 670),
 'img_05676.jpg': (1280, 750),
 'img_00409.jpg': (1280, 720),
 'img_02033.jpg': (1280, 720),
 'img_02174.jpg': (1276, 718),
 'img_00903.jpg': (1280, 720),
 'img_07806.jpg': (1280, 720),
 'img_01411.jpg': (1334, 750),
 'img_05122.jpg': (1518, 854),
 'img_07911.jpg': (1280, 720),
 'img_06995.jpg': (1280, 750),
 'img_01021.jpg': (1280, 750),
 'img_02148.jpg': (1280, 720),
 'img_07170.jpg': (1280, 750),
 'img_02696.jpg': (1280, 974),
 'img_01520.jpg': (1280, 750),
 'img_07359.jpg': (1280, 720),
 'img_06464.jpg': (1280, 720),
 'img_00461.jpg': (1280, 720),
 'img_05143.jpg': (1280, 720),
 'img_07643.jpg': (1280, 720),
 'img_04283.jpg': (1280, 750),
 'img_00687.jpg': (1280, 720),
 'img_05507.jpg': (1280, 750),
 'img_07020.jpg': (1280, 750),
 'img_01466.jpg': (1276, 718),
 'img_00043.jpg': (1280, 720),
 'img_07265.jpg': (1280, 974),
 'img_03179.jpg': (1280, 720),
 'img_03774.jpg': (1280, 720),
 'img_02557.jpg': (1280, 750),
 'img_02828.jpg': (1280, 720),
 'img_00354.jpg': (1732, 974),
 'img_02198.jpg': (1280, 720),
 'img_00281.jpg': (1280, 720),
 'img_02199.jpg': (1280, 924),
 'img_05957.jpg': (1280, 750),
 'img_00815.jpg': (1280, 720),
 'img_07730.jpg': (1280, 750),
 'img_00284.jpg': (1280, 720),
 'img_04711.jpg': (1280, 720),
 'img_07018.jpg': (1280, 720),
 'img_03530.jpg': (1280, 720),
 'img_02760.jpg': (1280, 720),
 'img_00523.jpg': (1280, 720),
 'img_04899.jpg': (1280, 720),
 'img_00317.jpg': (1192, 670),
 'img_00821.jpg': (1280, 720),
 'img_07670.jpg': (1276, 718),
 'img_05070.jpg': (1280, 720),
 'img_03712.jpg': (1280, 720),
 'img_07871.jpg': (1280, 720),
 'img_00218.jpg': (1280, 720),
 'img_04444.jpg': (1280, 750),
 'img_02149.jpg': (1280, 750),
 'img_05711.jpg': (1280, 720),
 'img_07226.jpg': (1280, 720),
 'img_01783.jpg': (1280, 974),
 'img_00193.jpg': (1280, 750),
 'img_04235.jpg': (1280, 720),
 'img_05226.jpg': (1280, 720),
 'img_07864.jpg': (1280, 720),
 'img_00015.jpg': (1280, 750),
 'img_04441.jpg': (1280, 720),
 'img_05067.jpg': (1280, 720),
 'img_00774.jpg': (1280, 974),
 'img_02583.jpg': (1280, 720),
 'img_07687.jpg': (1280, 750),
 'img_07015.jpg': (1280, 974),
 'img_06636.jpg': (1280, 720),
 'img_06708.jpg': (1280, 720),
 'img_05243.jpg': (1280, 720),
 'img_02461.jpg': (1276, 718),
 'img_05685.jpg': (1280, 720),
 'img_07424.jpg': (1280, 720),
 'img_02448.jpg': (1280, 720),
 'img_07072.jpg': (1280, 720),
 'img_00535.jpg': (1280, 720),
 'img_02007.jpg': (1280, 974),
 'img_01668.jpg': (1192, 670),
 'img_03315.jpg': (1280, 750),
 'img_07222.jpg': (1280, 750),
 'img_00890.jpg': (1280, 924),
 'img_07560.jpg': (1280, 720),
 'img_07684.jpg': (1192, 670),
 'img_07118.jpg': (1280, 720),
 'img_03807.jpg': (1280, 720),
 'img_04217.jpg': (1280, 750),
 'img_03708.jpg': (1280, 720),
 'img_01008.jpg': (1280, 720),
 'img_04866.jpg': (1280, 750),
 'img_01810.jpg': (1280, 750),
 'img_05397.jpg': (1280, 720),
 'img_03884.jpg': (1280, 720),
 'img_03424.jpg': (1280, 720),
 'img_04736.jpg': (1280, 720),
 'img_06527.jpg': (1192, 670),
 'img_07437.jpg': (1280, 720),
 'img_05554.jpg': (1280, 720),
 'img_07761.jpg': (1280, 974),
 'img_01461.jpg': (1276, 718),
 'img_00891.jpg': (1280, 974),
 'img_04738.jpg': (1280, 720),
 'img_05114.jpg': (1280, 720),
 'img_07463.jpg': (1280, 720),
 'img_00592.jpg': (1276, 718),
 'img_07167.jpg': (1280, 720),
 'img_03596.jpg': (1280, 974),
 'img_03119.jpg': (1280, 720),
 'img_01044.jpg': (1280, 720),
 'img_03949.jpg': (1280, 750),
 'img_02938.jpg': (1280, 720),
 'img_07408.jpg': (1280, 750),
 'img_06445.jpg': (1280, 720),
 'img_07414.jpg': (1280, 750),
 'img_04948.jpg': (1280, 720),
 'img_06868.jpg': (1280, 720),
 'img_01823.jpg': (1276, 718),
 'img_02805.jpg': (1732, 974),
 'img_05041.jpg': (1280, 720),
 'img_05733.jpg': (1280, 720),
 'img_07693.jpg': (1280, 720),
 'img_03092.jpg': (1280, 720),
 'img_04163.jpg': (1280, 720),
 'img_03565.jpg': (1280, 720),
 'img_07648.jpg': (1280, 974),
 'img_07136.jpg': (1280, 750),
 'img_04391.jpg': (1280, 720),
 'img_03174.jpg': (1280, 720),
 'img_03257.jpg': (1280, 750),
 'img_07039.jpg': (1280, 720),
 'img_00387.jpg': (1280, 720),
 'img_02802.jpg': (1280, 720),
 'img_00041.jpg': (1280, 720),
 'img_01218.jpg': (1280, 720),
 'img_01052.jpg': (1280, 720),
 'img_01139.jpg': (1280, 750),
 'img_06298.jpg': (1280, 720),
 'img_02435.jpg': (1280, 720),
 'img_01402.jpg': (1280, 720),
 'img_02809.jpg': (1280, 974),
 'img_06619.jpg': (1280, 720),
 'img_06706.jpg': (1280, 720),
 'img_04914.jpg': (1244, 700),
 'img_03429.jpg': (1280, 720),
 'img_02250.jpg': (1280, 924),
 'img_05617.jpg': (1280, 720),
 'img_01768.jpg': (1280, 720),
 'img_04917.jpg': (1280, 720),
 'img_02115.jpg': (1518, 854),
 'img_03860.jpg': (1192, 670),
 'img_00011.jpg': (1280, 720),
 'img_04630.jpg': (1192, 670),
 'img_07075.jpg': (1280, 750),
 'img_05928.jpg': (1732, 974),
 'img_01886.jpg': (1280, 720),
 'img_00400.jpg': (1280, 720),
 'img_07274.jpg': (1244, 700),
 'img_00478.jpg': (1280, 720),
 'img_04708.jpg': (1280, 720),
 'img_06406.jpg': (1280, 720),
 'img_06792.jpg': (1280, 750),
 'img_00338.jpg': (1280, 720),
 'img_03599.jpg': (1280, 720),
 'img_06422.jpg': (1280, 750),
 'img_05283.jpg': (1280, 750),
 'img_04365.jpg': (1280, 720),
 'img_05532.jpg': (1280, 974),
 'img_03833.jpg': (1280, 974),
 'img_00471.jpg': (1276, 718),
 'img_02886.jpg': (1280, 750),
 'img_02768.jpg': (1280, 720),
 'img_00840.jpg': (1276, 718),
 'img_03383.jpg': (1280, 720),
 'img_01243.jpg': (1280, 720),
 'img_01620.jpg': (1280, 720),
 'img_00021.jpg': (1280, 720),
 'img_02105.jpg': (1280, 720),
 'img_07081.jpg': (1192, 670),
 'img_03158.jpg': (1280, 720),
 'img_07857.jpg': (1280, 720),
 'img_00490.jpg': (1280, 720),
 'img_03048.jpg': (1280, 720),
 'img_02340.jpg': (1280, 750),
 'img_00184.jpg': (1280, 750),
 'img_00744.jpg': (1280, 720),
 'img_07285.jpg': (1192, 670),
 'img_04008.jpg': (1280, 720),
 'img_01855.jpg': (1280, 720),
 'img_00595.jpg': (1276, 718),
 'img_01071.jpg': (1280, 720),
 'img_04977.jpg': (1280, 750),
 'img_03549.jpg': (1280, 720),
 'img_05350.jpg': (1192, 670),
 'img_06827.jpg': (1280, 720),
 'img_05353.jpg': (1280, 720),
 'img_02558.jpg': (1280, 974),
 'img_03185.jpg': (1280, 974),
 'img_04486.jpg': (1280, 750),
 'img_00209.jpg': (1280, 720),
 'img_02680.jpg': (1280, 974),
 'img_06313.jpg': (1280, 720),
 'img_01343.jpg': (1280, 974),
 'img_02494.jpg': (1280, 720),
 'img_04793.jpg': (1280, 720),
 'img_00769.jpg': (1280, 974),
 'img_02744.jpg': (1280, 720),
 'img_01826.jpg': (1276, 718),
 'img_05158.jpg': (1280, 720),
 'img_00510.jpg': (1280, 974),
 'img_01271.jpg': (1280, 750),
 'img_02376.jpg': (1192, 670),
 'img_02897.jpg': (1280, 750),
 'img_05101.jpg': (1192, 670),
 'img_00023.jpg': (1280, 720),
 'img_05481.jpg': (1280, 720),
 'img_06360.jpg': (1280, 720),
 'img_02784.jpg': (1280, 720),
 'img_05694.jpg': (1280, 750),
 'img_04475.jpg': (1280, 750),
 'img_06686.jpg': (1280, 720),
 'img_02863.jpg': (1280, 720),
 'img_02592.jpg': (1280, 750),
 'img_02776.jpg': (1280, 720),
 'img_05818.jpg': (1276, 718),
 'img_06303.jpg': (1280, 974),
 'img_03131.jpg': (1280, 720),
 'img_07673.jpg': (1280, 720),
 'img_03607.jpg': (1280, 924),
 'img_01678.jpg': (1280, 720),
 'img_02008.jpg': (1280, 720),
 'img_01749.jpg': (1280, 750),
 'img_05855.jpg': (1280, 720),
 'img_00677.jpg': (1280, 750),
 'img_06567.jpg': (1280, 750),
 'img_05765.jpg': (1280, 720),
 'img_05625.jpg': (1276, 718),
 'img_05503.jpg': (1280, 720),
 'img_00368.jpg': (1280, 720),
 'img_05345.jpg': (1280, 720),
 'img_05163.jpg': (1280, 720),
 'img_06903.jpg': (1280, 720),
 'img_03183.jpg': (1280, 720),
 'img_01634.jpg': (1280, 720),
 'img_01311.jpg': (1280, 720),
 'img_02014.jpg': (1280, 720),
 'img_04188.jpg': (1280, 750),
 'img_02919.jpg': (1280, 720),
 'img_02260.jpg': (1280, 750),
 'img_07698.jpg': (1280, 720),
 'img_04950.jpg': (1280, 720),
 'img_05604.jpg': (1280, 750),
 'img_01699.jpg': (1280, 720),
 'img_00536.jpg': (1280, 750),
 'img_01118.jpg': (1276, 718),
 'img_03636.jpg': (1280, 720),
 'img_03540.jpg': (1280, 720),
 'img_03779.jpg': (1280, 720),
 'img_04567.jpg': (1280, 720),
 'img_07439.jpg': (1280, 720),
 'img_06707.jpg': (1280, 720),
 'img_01001.jpg': (1192, 670),
 'img_05133.jpg': (1280, 720),
 'img_03791.jpg': (1280, 720),
 'img_01323.jpg': (1280, 750),
 'img_06497.jpg': (1280, 720),
 'img_04513.jpg': (1280, 750),
 'img_03567.jpg': (1280, 974),
 'img_07886.jpg': (1280, 720),
 'img_00690.jpg': (1280, 750),
 'img_06818.jpg': (1280, 720),
 'img_06742.jpg': (1280, 750),
 'img_00781.jpg': (1280, 720),
 'img_02996.jpg': (1280, 974),
 'img_07701.jpg': (1280, 720),
 'img_01356.jpg': (1280, 720),
 'img_01398.jpg': (1280, 750),
 'img_07554.jpg': (1192, 670),
 'img_00097.jpg': (1280, 720),
 'img_01469.jpg': (1280, 720),
 'img_01941.jpg': (1280, 924),
 'img_07577.jpg': (1280, 720),
 'img_04124.jpg': (1280, 720),
 'img_03189.jpg': (1280, 974),
 'img_04911.jpg': (1280, 720),
 'img_02721.jpg': (1280, 720),
 'img_05618.jpg': (1280, 720),
 'img_06613.jpg': (1244, 700),
 'img_02107.jpg': (1280, 720),
 'img_04087.jpg': (1280, 720),
 'img_05237.jpg': (1280, 750),
 'img_06843.jpg': (1280, 720),
 'img_03509.jpg': (1280, 974),
 'img_03020.jpg': (1280, 720),
 'img_05024.jpg': (1280, 750),
 'img_01769.jpg': (1280, 974),
 'img_05971.jpg': (1280, 720),
 'img_06239.jpg': (1280, 720),
 'img_07115.jpg': (1244, 700),
 'img_06771.jpg': (1280, 750),
 'img_01375.jpg': (1280, 750),
 'img_07447.jpg': (1280, 720),
 'img_07732.jpg': (1192, 670),
 'img_02365.jpg': (1280, 720),
 'img_03880.jpg': (1280, 750),
 'img_01865.jpg': (1280, 750),
 'img_07883.jpg': (1280, 720),
 'img_06022.jpg': (1280, 720),
 'img_05088.jpg': (1280, 750),
 'img_05048.jpg': (1280, 974),
 'img_06777.jpg': (1280, 750),
 'img_03742.jpg': (1280, 750),
 'img_05089.jpg': (1280, 720),
 'img_05466.jpg': (1280, 720),
 'img_03300.jpg': (1280, 720),
 'img_07059.jpg': (1192, 670),
 'img_04721.jpg': (1280, 720),
 'img_06126.jpg': (1280, 720),
 'img_01194.jpg': (1280, 720),
 'img_05029.jpg': (1280, 720),
 'img_03035.jpg': (1280, 720),
 'img_00286.jpg': (1280, 720),
 'img_05575.jpg': (1280, 720),
 'img_02798.jpg': (1280, 974),
 'img_01912.jpg': (1280, 720),
 'img_03841.jpg': (1280, 720),
 'img_07727.jpg': (1280, 720),
 'img_00771.jpg': (1192, 670),
 'img_05228.jpg': (1280, 720),
 'img_03730.jpg': (1276, 718),
 'img_01304.jpg': (1280, 720),
 'img_06772.jpg': (1518, 854),
 'img_06568.jpg': (1280, 720),
 'img_00206.jpg': (1192, 670),
 'img_07671.jpg': (1280, 720),
 'img_05485.jpg': (1280, 720),
 'img_06884.jpg': (1280, 750),
 'img_00069.jpg': (1280, 974),
 'img_06344.jpg': (1192, 670),
 'img_06383.jpg': (1280, 720),
 'img_06072.jpg': (1280, 974),
 'img_07046.jpg': (1280, 750),
 'img_03643.jpg': (1334, 750),
 'img_06244.jpg': (1280, 720),
 'img_03065.jpg': (1280, 720),
 'img_03654.jpg': (1280, 720),
 'img_00820.jpg': (1280, 720),
 'img_05635.jpg': (1280, 720),
 'img_02915.jpg': (1280, 720),
 'img_02013.jpg': (1334, 750),
 'img_00703.jpg': (1280, 720),
 'img_04681.jpg': (1280, 974),
 'img_02469.jpg': (1280, 720),
 'img_01040.jpg': (1280, 720),
 'img_07916.jpg': (1280, 720),
 'img_06495.jpg': (1334, 750),
 'img_03947.jpg': (1280, 750),
 'img_02541.jpg': (1280, 720),
 'img_01080.jpg': (1280, 720),
 'img_05873.jpg': (1280, 720),
 'img_04547.jpg': (1280, 750),
 'img_00084.jpg': (1276, 718),
 'img_02801.jpg': (1280, 720),
 'img_02695.jpg': (1280, 720),
 'img_07286.jpg': (1280, 720),
 'img_00435.jpg': (1280, 720),
 'img_04878.jpg': (1280, 750),
 'img_01664.jpg': (1280, 720),
 'img_04545.jpg': (1192, 670),
 'img_07785.jpg': (1244, 700),
 'img_03489.jpg': (1280, 750),
 'img_06879.jpg': (1280, 720),
 'img_00247.jpg': (1280, 750),
 'img_07774.jpg': (1280, 720),
 'img_00245.jpg': (1280, 974),
 'img_06434.jpg': (1280, 974),
 'img_06487.jpg': (1280, 750),
 'img_02658.jpg': (1280, 720),
 'img_05106.jpg': (1280, 720),
 'img_06215.jpg': (1280, 750),
 'img_03477.jpg': (1280, 720),
 'img_03543.jpg': (1280, 720),
 'img_00300.jpg': (1276, 718),
 'img_04592.jpg': (1280, 720),
 'img_04259.jpg': (1280, 750),
 'img_07709.jpg': (1280, 750),
 'img_00372.jpg': (1280, 720),
 'img_04350.jpg': (1280, 720),
 'img_02718.jpg': (1280, 720),
 'img_03972.jpg': (1276, 718),
 'img_01111.jpg': (1280, 720),
 'img_07258.jpg': (1334, 750),
 'img_01784.jpg': (1280, 750),
 'img_02926.jpg': (1280, 720),
 'img_02867.jpg': (1280, 720),
 'img_03123.jpg': (1192, 670),
 'img_00008.jpg': (1280, 720),
 'img_00222.jpg': (1280, 720),
 'img_00356.jpg': (1280, 720),
 'img_05040.jpg': (1280, 720),
 'img_06094.jpg': (1280, 750),
 'img_01151.jpg': (1280, 720),
 'img_04316.jpg': (1280, 974),
 'img_06652.jpg': (1280, 720),
 'img_02918.jpg': (1280, 720),
 'img_04568.jpg': (1280, 974),
 'img_00507.jpg': (1280, 720),
 'img_00898.jpg': (1280, 720),
 'img_00926.jpg': (1276, 718),
 'img_01507.jpg': (1280, 720),
 'img_04983.jpg': (1276, 718),
 'img_03623.jpg': (1192, 670),
 'img_01429.jpg': (1280, 974),
 'img_03215.jpg': (1192, 670),
 'img_01403.jpg': (1280, 720),
 'img_01902.jpg': (1280, 720),
 'img_03186.jpg': (1280, 720),
 'img_06220.jpg': (1280, 974),
 'img_06627.jpg': (1280, 720),
 'img_07048.jpg': (1280, 720),
 'img_04366.jpg': (1280, 720),
 'img_04196.jpg': (1280, 720),
 'img_04632.jpg': (1280, 974),
 'img_01959.jpg': (1276, 718),
 'img_03296.jpg': (1280, 720),
 'img_02457.jpg': (1280, 720),
 'img_03699.jpg': (1280, 720),
 'img_04148.jpg': (1280, 720),
 'img_07443.jpg': (1192, 670),
 'img_02719.jpg': (1280, 720),
 'img_02432.jpg': (1280, 974),
 'img_06277.jpg': (1280, 974),
 'img_02410.jpg': (1280, 720),
 'img_07869.jpg': (1276, 718),
 'img_05852.jpg': (1280, 720),
 'img_01128.jpg': (1280, 720),
 'img_05012.jpg': (1280, 720),
 'img_07133.jpg': (1280, 720),
 'img_02308.jpg': (1280, 750),
 'img_07031.jpg': (1280, 924),
 'img_05069.jpg': (1280, 720),
 'img_01056.jpg': (1192, 670),
 'img_02051.jpg': (1280, 720),
 'img_04050.jpg': (1280, 720),
 'img_00187.jpg': (1280, 750),
 'img_00091.jpg': (1280, 720),
 'img_07892.jpg': (1280, 720),
 'img_00219.jpg': (1280, 974),
 'img_02220.jpg': (1280, 750),
 'img_07576.jpg': (1280, 720),
 'img_05252.jpg': (1280, 974),
 'img_00630.jpg': (1280, 720),
 'img_07797.jpg': (1280, 720),
 'img_06347.jpg': (1280, 750),
 'img_01588.jpg': (1276, 718),
 'img_05648.jpg': (1192, 670),
 'img_06061.jpg': (1280, 720),
 'img_05066.jpg': (1276, 718),
 'img_00539.jpg': (1280, 974),
 'img_00022.jpg': (1280, 720),
 'img_05382.jpg': (1280, 750),
 'img_05446.jpg': (1280, 974),
 'img_03963.jpg': (1280, 720),
 'img_06553.jpg': (1280, 720),
 'img_01790.jpg': (1280, 720),
 'img_00359.jpg': (1280, 720),
 'img_01527.jpg': (1280, 720),
 'img_06407.jpg': (1280, 720),
 'img_01492.jpg': (1280, 720),
 'img_07665.jpg': (1280, 720),
 'img_07276.jpg': (1280, 720),
 'img_02084.jpg': (1280, 720),
 'img_00288.jpg': (1280, 720),
 'img_02604.jpg': (1280, 750),
 'img_02360.jpg': (1280, 720),
 'img_00072.jpg': (1280, 720),
 'img_05926.jpg': (1280, 720),
 'img_07770.jpg': (1280, 720),
 'img_05057.jpg': (1280, 750),
 'img_00818.jpg': (1276, 718),
 'img_00502.jpg': (1280, 720),
 'img_04621.jpg': (1280, 720),
 'img_00747.jpg': (1280, 924),
 'img_03150.jpg': (1280, 720),
 'img_04458.jpg': (1280, 750),
 'img_03241.jpg': (1280, 720),
 'img_02785.jpg': (1276, 718),
 'img_05482.jpg': (1280, 720),
 'img_03507.jpg': (1280, 750),
 'img_00365.jpg': (1280, 974),
 'img_00601.jpg': (1280, 974),
 'img_07396.jpg': (1280, 750),
 'img_02427.jpg': (1280, 974),
 'img_01866.jpg': (1280, 720),
 'img_01753.jpg': (1280, 720),
 'img_00783.jpg': (1280, 974),
 'img_07801.jpg': (1280, 720),
 'img_00360.jpg': (1280, 750),
 'img_04762.jpg': (1280, 720),
 'img_01779.jpg': (1280, 720),
 'img_05681.jpg': (1192, 670),
 'img_04680.jpg': (1280, 720),
 'img_01006.jpg': (1280, 750),
 'img_02173.jpg': (1280, 750),
 'img_00437.jpg': (1280, 720),
 'img_03649.jpg': (1280, 720),
 'img_00596.jpg': (1280, 720),
 'img_07472.jpg': (1280, 720),
 'img_07537.jpg': (1280, 924),
 'img_02362.jpg': (1280, 750),
 'img_00843.jpg': (1280, 720),
 'img_01980.jpg': (1280, 720),
 'img_04617.jpg': (1280, 720),
 'img_04236.jpg': (1280, 750),
 'img_02393.jpg': (1280, 720),
 'img_05728.jpg': (1280, 974),
 'img_05152.jpg': (1280, 720),
 'img_02937.jpg': (1280, 974),
 'img_02685.jpg': (1280, 720),
 'img_03686.jpg': (1280, 750),
 'img_03645.jpg': (1280, 720),
 'img_05778.jpg': (1280, 720),
 'img_03347.jpg': (1280, 974),
 'img_06090.jpg': (1280, 720),
 'img_05384.jpg': (1280, 720),
 'img_07810.jpg': (1280, 720),
 'img_05358.jpg': (1280, 720),
 'img_01446.jpg': (1280, 720),
 'img_01516.jpg': (1280, 720),
 'img_00130.jpg': (1280, 750),
 'img_06420.jpg': (1280, 720),
 'img_00085.jpg': (1280, 720),
 'img_00762.jpg': (1280, 750),
 'img_03948.jpg': (1280, 974),
 'img_01415.jpg': (1280, 720),
 'img_07503.jpg': (1280, 720),
 'img_06096.jpg': (1280, 720),
 'img_06105.jpg': (1280, 720),
 'img_06417.jpg': (1280, 750),
 'img_01448.jpg': (1280, 720),
 ...}&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [26]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'./data/boxes/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;boxes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;bxs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bxs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bxs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;{'filename': 'img_07917.jpg', 'annotations': [{'y': 193.3597426816281, 'width': 383.68430384213445, 'height': 151.06975503141317, 'x': 547.1578480789353, 'class': 'rect'}], 'class': 'image'}
[{'y': 193.3597426816281, 'width': 383.68430384213445, 'height': 151.06975503141317, 'x': 547.1578480789353, 'class': 'rect'}]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So the annotations appear to be a list, the key parameter is the 'filename' parameter. We will also need to transform the coords as we have resized all of the images.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;A simple function to transform the coordinates of the bounding boxes.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [27]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;convert_bb&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;224&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;224&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
    &lt;span class="n"&gt;factor_x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;factor_y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'height'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'height'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;factor_y&lt;/span&gt;
    &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'width'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'width'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;factor_x&lt;/span&gt;
    &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;factor_x&lt;/span&gt;
    &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'y'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'y'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;factor_y&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Here we construct a dictionary whose keys are the filenames. The idea is we can use the filenames to find out the box meta-data.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [28]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;null_largest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'width'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
               &lt;span class="s1"&gt;'height'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
               &lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;224&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
               &lt;span class="s1"&gt;'y'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;224&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;file2boxes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;boxes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'./data/boxes/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;bxs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;blabel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;findall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'[a-zA-Z]*'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;bxs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'label'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;blabel&lt;/span&gt;
            
            &lt;span class="n"&gt;fname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'filename'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;'data'&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;fname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;existing&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;file2boxes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            
            &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;convert_bb&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;all_sizes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
            
            &lt;span class="c1"&gt;# Inplace sort so that we can find the largest box.&lt;/span&gt;
            &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'width'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'height'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
            
            &lt;span class="c1"&gt;# Now lets just take the largest (last one)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;largest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;null_largest&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;largest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
                
            &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'box_loc'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'width'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'height'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'y'&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
            
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;existing&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;file2boxes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;file2boxes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fname&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'annotations'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
                
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Some of the files are unrepresented. Let's make sure they have a null largest.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [29]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_boxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file2boxes&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;file2boxes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null_largest&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;null_largest&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;boxes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;nlarge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;null_largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'width'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;null_largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'height'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;null_largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;null_largest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'y'&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filenames&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;meta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;file2boxes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;meta&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;boxes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nlarge&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;largest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;meta&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'box_loc'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;boxes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;largest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;boxes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Prepare-the-second-output-labels"&gt;Prepare the second output labels&lt;a class="anchor-link" href="#Prepare-the-second-output-labels"&gt;Â¶&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Now we have the labels, we need to line them up with the other data labels for train, valid and sample. The generators from each will help us with this.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [30]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;train_boxes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_boxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;train_gen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;valid_boxes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_boxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;valid_gen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sample_boxes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_boxes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sample_gen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Let's-use-the-previous-simple-model."&gt;Let's use the previous simple model.&lt;a class="anchor-link" href="#Let's-use-the-previous-simple-model."&gt;Â¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [31]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;simple&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
    &lt;span class="n"&gt;InputLayer&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;MaxPooling2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
  &lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;simple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 256, 256, 3)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 254, 254, 16)      448       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 63, 63, 16)        0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 61, 61, 16)        2320      
=================================================================
Total params: 2,768.0
Trainable params: 2,768.0
Non-trainable params: 0.0
_________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;inp&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Input&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;sim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;simple&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;c1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))(&lt;/span&gt;&lt;span class="n"&gt;sim&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;out1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GlobalMaxPool2D&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;c1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;c2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))(&lt;/span&gt;&lt;span class="n"&gt;sim&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;out2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GlobalMaxPool2D&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;c2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dualSimple&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;inp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outputs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;out1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;out2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dualSimple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'adam'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
              &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'mse'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
              &lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'accuracy'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
             &lt;span class="n"&gt;loss_weights&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;dualSimple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dualSimple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;[:],&lt;/span&gt; &lt;span class="n"&gt;train_boxes&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;epochs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;validation_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;val_labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;valid_boxes&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Train on 3025 samples, validate on 752 samples
Epoch 1/3
3025/3025 [==============================] - 20s - loss: 10.5559 - global_max_pooling2d_1_loss: 1.8870 - global_max_pooling2d_2_loss: 866.8852 - global_max_pooling2d_1_acc: 0.3898 - global_max_pooling2d_2_acc: 0.5676 - val_loss: 3.0985 - val_global_max_pooling2d_1_loss: 1.7335 - val_global_max_pooling2d_2_loss: 136.4989 - val_global_max_pooling2d_1_acc: 0.4561 - val_global_max_pooling2d_2_acc: 0.1077
Epoch 2/3
3025/3025 [==============================] - 16s - loss: 2.8031 - global_max_pooling2d_1_loss: 1.6750 - global_max_pooling2d_2_loss: 112.8190 - global_max_pooling2d_1_acc: 0.4549 - global_max_pooling2d_2_acc: 0.4175 - val_loss: 2.4116 - val_global_max_pooling2d_1_loss: 1.6376 - val_global_max_pooling2d_2_loss: 77.4025 - val_global_max_pooling2d_1_acc: 0.4561 - val_global_max_pooling2d_2_acc: 0.6237
Epoch 3/3
3025/3025 [==============================] - 16s - loss: 2.3125 - global_max_pooling2d_1_loss: 1.6412 - global_max_pooling2d_2_loss: 67.1315 - global_max_pooling2d_1_acc: 0.4549 - global_max_pooling2d_2_acc: 0.5091 - val_loss: 2.2237 - val_global_max_pooling2d_1_loss: 1.6337 - val_global_max_pooling2d_2_loss: 59.0001 - val_global_max_pooling2d_1_acc: 0.4561 - val_global_max_pooling2d_2_acc: 0.5984
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[20]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&lt;keras.callbacks.history at 0x7f25f7ed26a0&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Now-Try-with-pretrained-model-+-convolutions."&gt;Now Try with pretrained model + convolutions.&lt;a class="anchor-link" href="#Now-Try-with-pretrained-model-+-convolutions."&gt;Â¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [32]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;conv_top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;InputLayer&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2048&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
                       &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                       &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                       &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                       &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                       &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                       &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                      &lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;inp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Input&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2048&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;ct&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conv_top&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# ct is the convolution top output.&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;ct&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GlobalAveragePooling2D&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;out1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'softmax'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'class'&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;ct&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;()(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;out2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GlobalAveragePooling2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'box'&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;conv_model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inputs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;inp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outputs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;out1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;out2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;conv_model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'adam'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'mse'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
                 &lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'accuracy'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;loss_weights&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;conv_model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
input_5 (InputLayer)             (None, 8, 8, 2048)    0                                            
____________________________________________________________________________________________________
sequential_3 (Sequential)        (None, 8, 8, 32)      608736                                       
____________________________________________________________________________________________________
conv2d_13 (Conv2D)               (None, 8, 8, 8)       2312                                         
____________________________________________________________________________________________________
batch_normalization_11 (BatchNor (None, 8, 8, 8)       32                                           
____________________________________________________________________________________________________
conv2d_15 (Conv2D)               (None, 8, 8, 4)       1156                                         
____________________________________________________________________________________________________
conv2d_14 (Conv2D)               (None, 8, 8, 8)       584                                          
____________________________________________________________________________________________________
batch_normalization_13 (BatchNor (None, 8, 8, 4)       16                                           
____________________________________________________________________________________________________
batch_normalization_12 (BatchNor (None, 8, 8, 8)       32                                           
____________________________________________________________________________________________________
conv2d_16 (Conv2D)               (None, 8, 8, 4)       148                                          
____________________________________________________________________________________________________
global_average_pooling2d_2 (Glob (None, 8)             0                                            
____________________________________________________________________________________________________
batch_normalization_14 (BatchNor (None, 8, 8, 4)       16                                           
____________________________________________________________________________________________________
class (Activation)               (None, 8)             0                                            
____________________________________________________________________________________________________
box (GlobalAveragePooling2D)     (None, 4)             0                                            
====================================================================================================
Total params: 613,032.0
Trainable params: 612,792.0
Non-trainable params: 240.0
____________________________________________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [33]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;xCdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'pretrained'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;xValdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'pretrained'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valdata'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [42]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;conv_model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-1&lt;/span&gt;

&lt;span class="n"&gt;conv_model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xCdata&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;train_boxes&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;epochs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;validation_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xValdata&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;val_labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;valid_boxes&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;verbose&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Train on 3025 samples, validate on 752 samples
Epoch 1/50
10s - loss: 7.4551 - class_loss: 1.5769 - box_loss: 5878.2130 - class_acc: 0.6635 - box_acc: 0.2694 - val_loss: 7.8971 - val_class_loss: 2.1183 - val_box_loss: 5778.8451 - val_class_acc: 0.2168 - val_box_acc: 0.2301
Epoch 2/50
10s - loss: 7.4516 - class_loss: 1.5734 - box_loss: 5878.2536 - class_acc: 0.6641 - box_acc: 0.2704 - val_loss: 7.8868 - val_class_loss: 2.1061 - val_box_loss: 5780.6274 - val_class_acc: 0.2261 - val_box_acc: 0.2261
Epoch 3/50
10s - loss: 7.4502 - class_loss: 1.5720 - box_loss: 5878.2218 - class_acc: 0.6671 - box_acc: 0.2701 - val_loss: 7.8781 - val_class_loss: 2.0975 - val_box_loss: 5780.6206 - val_class_acc: 0.2354 - val_box_acc: 0.2314
Epoch 4/50
11s - loss: 7.4472 - class_loss: 1.5691 - box_loss: 5878.1109 - class_acc: 0.6688 - box_acc: 0.2737 - val_loss: 7.8912 - val_class_loss: 2.1106 - val_box_loss: 5780.5943 - val_class_acc: 0.2154 - val_box_acc: 0.2380
Epoch 5/50
10s - loss: 7.4444 - class_loss: 1.5663 - box_loss: 5878.0921 - class_acc: 0.6707 - box_acc: 0.2707 - val_loss: 7.8887 - val_class_loss: 2.1096 - val_box_loss: 5779.1064 - val_class_acc: 0.2247 - val_box_acc: 0.2287
Epoch 6/50
10s - loss: 7.4427 - class_loss: 1.5647 - box_loss: 5877.9837 - class_acc: 0.6740 - box_acc: 0.2760 - val_loss: 7.8926 - val_class_loss: 2.1120 - val_box_loss: 5780.6735 - val_class_acc: 0.2181 - val_box_acc: 0.2367
Epoch 7/50
10s - loss: 7.4380 - class_loss: 1.5601 - box_loss: 5877.9881 - class_acc: 0.6731 - box_acc: 0.2661 - val_loss: 7.8910 - val_class_loss: 2.1102 - val_box_loss: 5780.8347 - val_class_acc: 0.2207 - val_box_acc: 0.2340
Epoch 8/50
10s - loss: 7.4382 - class_loss: 1.5603 - box_loss: 5877.9042 - class_acc: 0.6750 - box_acc: 0.2701 - val_loss: 7.8948 - val_class_loss: 2.1150 - val_box_loss: 5779.7767 - val_class_acc: 0.2247 - val_box_acc: 0.2314
Epoch 9/50
11s - loss: 7.4306 - class_loss: 1.5528 - box_loss: 5877.8457 - class_acc: 0.6737 - box_acc: 0.2731 - val_loss: 7.8943 - val_class_loss: 2.1145 - val_box_loss: 5779.7899 - val_class_acc: 0.2247 - val_box_acc: 0.2394
Epoch 10/50
12s - loss: 7.4321 - class_loss: 1.5543 - box_loss: 5877.7882 - class_acc: 0.6760 - box_acc: 0.2724 - val_loss: 7.8886 - val_class_loss: 2.1077 - val_box_loss: 5780.9016 - val_class_acc: 0.2234 - val_box_acc: 0.2274
Epoch 11/50
11s - loss: 7.4295 - class_loss: 1.5517 - box_loss: 5877.7257 - class_acc: 0.6803 - box_acc: 0.2678 - val_loss: 7.9017 - val_class_loss: 2.1240 - val_box_loss: 5777.7094 - val_class_acc: 0.2261 - val_box_acc: 0.2274
Epoch 12/50
12s - loss: 7.4267 - class_loss: 1.5489 - box_loss: 5877.7502 - class_acc: 0.6754 - box_acc: 0.2671 - val_loss: 7.8666 - val_class_loss: 2.0834 - val_box_loss: 5783.1535 - val_class_acc: 0.2447 - val_box_acc: 0.2274
Epoch 13/50
10s - loss: 7.4266 - class_loss: 1.5490 - box_loss: 5877.6248 - class_acc: 0.6777 - box_acc: 0.2731 - val_loss: 7.8920 - val_class_loss: 2.1125 - val_box_loss: 5779.4986 - val_class_acc: 0.2301 - val_box_acc: 0.2327
Epoch 14/50
10s - loss: 7.4237 - class_loss: 1.5461 - box_loss: 5877.6094 - class_acc: 0.6790 - box_acc: 0.2747 - val_loss: 7.8777 - val_class_loss: 2.0969 - val_box_loss: 5780.7517 - val_class_acc: 0.2407 - val_box_acc: 0.2274
Epoch 15/50
10s - loss: 7.4186 - class_loss: 1.5410 - box_loss: 5877.5319 - class_acc: 0.6840 - box_acc: 0.2727 - val_loss: 7.8908 - val_class_loss: 2.1110 - val_box_loss: 5779.8223 - val_class_acc: 0.2354 - val_box_acc: 0.2354
Epoch 16/50
10s - loss: 7.4162 - class_loss: 1.5387 - box_loss: 5877.4903 - class_acc: 0.6836 - box_acc: 0.2704 - val_loss: 7.8849 - val_class_loss: 2.1032 - val_box_loss: 5781.7840 - val_class_acc: 0.2367 - val_box_acc: 0.2407
Epoch 17/50
10s - loss: 7.4122 - class_loss: 1.5347 - box_loss: 5877.5028 - class_acc: 0.6945 - box_acc: 0.2701 - val_loss: 7.9116 - val_class_loss: 2.1349 - val_box_loss: 5776.7147 - val_class_acc: 0.2141 - val_box_acc: 0.2340
Epoch 18/50
10s - loss: 7.4094 - class_loss: 1.5320 - box_loss: 5877.3756 - class_acc: 0.6869 - box_acc: 0.2707 - val_loss: 7.8986 - val_class_loss: 2.1196 - val_box_loss: 5778.9709 - val_class_acc: 0.2207 - val_box_acc: 0.2434
Epoch 19/50
12s - loss: 7.4095 - class_loss: 1.5321 - box_loss: 5877.3517 - class_acc: 0.6866 - box_acc: 0.2711 - val_loss: 7.8871 - val_class_loss: 2.1068 - val_box_loss: 5780.3197 - val_class_acc: 0.2340 - val_box_acc: 0.2340
Epoch 20/50
12s - loss: 7.4051 - class_loss: 1.5278 - box_loss: 5877.2850 - class_acc: 0.6962 - box_acc: 0.2684 - val_loss: 7.8825 - val_class_loss: 2.1024 - val_box_loss: 5780.0639 - val_class_acc: 0.2407 - val_box_acc: 0.2314
Epoch 21/50
12s - loss: 7.4077 - class_loss: 1.5304 - box_loss: 5877.2550 - class_acc: 0.6949 - box_acc: 0.2678 - val_loss: 7.8906 - val_class_loss: 2.1103 - val_box_loss: 5780.3194 - val_class_acc: 0.2301 - val_box_acc: 0.2287
Epoch 22/50
11s - loss: 7.4054 - class_loss: 1.5282 - box_loss: 5877.1532 - class_acc: 0.6916 - box_acc: 0.2704 - val_loss: 7.9023 - val_class_loss: 2.1232 - val_box_loss: 5779.0454 - val_class_acc: 0.2194 - val_box_acc: 0.2367
Epoch 23/50
11s - loss: 7.3986 - class_loss: 1.5214 - box_loss: 5877.1802 - class_acc: 0.6995 - box_acc: 0.2691 - val_loss: 7.8941 - val_class_loss: 2.1147 - val_box_loss: 5779.3671 - val_class_acc: 0.2301 - val_box_acc: 0.2327
Epoch 24/50
10s - loss: 7.3976 - class_loss: 1.5205 - box_loss: 5877.1672 - class_acc: 0.6942 - box_acc: 0.2688 - val_loss: 7.9036 - val_class_loss: 2.1258 - val_box_loss: 5777.8122 - val_class_acc: 0.2301 - val_box_acc: 0.2340
Epoch 25/50
11s - loss: 7.3936 - class_loss: 1.5165 - box_loss: 5877.0203 - class_acc: 0.7002 - box_acc: 0.2701 - val_loss: 7.9263 - val_class_loss: 2.1496 - val_box_loss: 5776.7462 - val_class_acc: 0.2048 - val_box_acc: 0.2434
Epoch 26/50
11s - loss: 7.3931 - class_loss: 1.5161 - box_loss: 5877.0190 - class_acc: 0.6912 - box_acc: 0.2704 - val_loss: 7.9089 - val_class_loss: 2.1305 - val_box_loss: 5778.3832 - val_class_acc: 0.2207 - val_box_acc: 0.2380
Epoch 27/50
11s - loss: 7.3873 - class_loss: 1.5104 - box_loss: 5876.9228 - class_acc: 0.7018 - box_acc: 0.2698 - val_loss: 7.9006 - val_class_loss: 2.1219 - val_box_loss: 5778.7269 - val_class_acc: 0.2274 - val_box_acc: 0.2447
Epoch 28/50
11s - loss: 7.3868 - class_loss: 1.5099 - box_loss: 5876.8570 - class_acc: 0.7008 - box_acc: 0.2681 - val_loss: 7.9297 - val_class_loss: 2.1546 - val_box_loss: 5775.1525 - val_class_acc: 0.2035 - val_box_acc: 0.2487
Epoch 29/50
11s - loss: 7.3823 - class_loss: 1.5054 - box_loss: 5876.8710 - class_acc: 0.7078 - box_acc: 0.2747 - val_loss: 7.9123 - val_class_loss: 2.1349 - val_box_loss: 5777.3507 - val_class_acc: 0.2154 - val_box_acc: 0.2420
Epoch 30/50
12s - loss: 7.3833 - class_loss: 1.5065 - box_loss: 5876.7657 - class_acc: 0.7041 - box_acc: 0.2744 - val_loss: 7.9080 - val_class_loss: 2.1296 - val_box_loss: 5778.3712 - val_class_acc: 0.2168 - val_box_acc: 0.2473
Epoch 31/50
11s - loss: 7.3783 - class_loss: 1.5016 - box_loss: 5876.7030 - class_acc: 0.7111 - box_acc: 0.2747 - val_loss: 7.9049 - val_class_loss: 2.1258 - val_box_loss: 5779.0690 - val_class_acc: 0.2247 - val_box_acc: 0.2540
Epoch 32/50
12s - loss: 7.3760 - class_loss: 1.4993 - box_loss: 5876.7084 - class_acc: 0.7061 - box_acc: 0.2674 - val_loss: 7.9134 - val_class_loss: 2.1354 - val_box_loss: 5777.9656 - val_class_acc: 0.2168 - val_box_acc: 0.2407
Epoch 33/50
11s - loss: 7.3730 - class_loss: 1.4964 - box_loss: 5876.6351 - class_acc: 0.7117 - box_acc: 0.2714 - val_loss: 7.9110 - val_class_loss: 2.1326 - val_box_loss: 5778.3908 - val_class_acc: 0.2181 - val_box_acc: 0.2460
Epoch 34/50
11s - loss: 7.3686 - class_loss: 1.4920 - box_loss: 5876.5847 - class_acc: 0.7078 - box_acc: 0.2737 - val_loss: 7.9046 - val_class_loss: 2.1251 - val_box_loss: 5779.5100 - val_class_acc: 0.2234 - val_box_acc: 0.2327
Epoch 35/50
11s - loss: 7.3685 - class_loss: 1.4920 - box_loss: 5876.5400 - class_acc: 0.7124 - box_acc: 0.2704 - val_loss: 7.8963 - val_class_loss: 2.1174 - val_box_loss: 5778.9520 - val_class_acc: 0.2314 - val_box_acc: 0.2340
Epoch 36/50
10s - loss: 7.3675 - class_loss: 1.4909 - box_loss: 5876.5216 - class_acc: 0.7071 - box_acc: 0.2734 - val_loss: 7.9050 - val_class_loss: 2.1257 - val_box_loss: 5779.3316 - val_class_acc: 0.2234 - val_box_acc: 0.2500
Epoch 37/50
10s - loss: 7.3629 - class_loss: 1.4865 - box_loss: 5876.3815 - class_acc: 0.7147 - box_acc: 0.2714 - val_loss: 7.8849 - val_class_loss: 2.1042 - val_box_loss: 5780.7195 - val_class_acc: 0.2407 - val_box_acc: 0.2434
Epoch 38/50
10s - loss: 7.3638 - class_loss: 1.4875 - box_loss: 5876.3696 - class_acc: 0.7150 - box_acc: 0.2717 - val_loss: 7.9133 - val_class_loss: 2.1373 - val_box_loss: 5775.9858 - val_class_acc: 0.2181 - val_box_acc: 0.2434
Epoch 39/50
10s - loss: 7.3599 - class_loss: 1.4836 - box_loss: 5876.3230 - class_acc: 0.7147 - box_acc: 0.2721 - val_loss: 7.8962 - val_class_loss: 2.1157 - val_box_loss: 5780.4590 - val_class_acc: 0.2420 - val_box_acc: 0.2434
Epoch 40/50
10s - loss: 7.3540 - class_loss: 1.4777 - box_loss: 5876.2577 - class_acc: 0.7220 - box_acc: 0.2711 - val_loss: 7.9238 - val_class_loss: 2.1471 - val_box_loss: 5776.6997 - val_class_acc: 0.2048 - val_box_acc: 0.2487
Epoch 41/50
10s - loss: 7.3534 - class_loss: 1.4772 - box_loss: 5876.1935 - class_acc: 0.7167 - box_acc: 0.2770 - val_loss: 7.8969 - val_class_loss: 2.1168 - val_box_loss: 5780.1268 - val_class_acc: 0.2247 - val_box_acc: 0.2434
Epoch 42/50
10s - loss: 7.3514 - class_loss: 1.4752 - box_loss: 5876.1586 - class_acc: 0.7134 - box_acc: 0.2737 - val_loss: 7.9024 - val_class_loss: 2.1225 - val_box_loss: 5779.8915 - val_class_acc: 0.2367 - val_box_acc: 0.2487
Epoch 43/50
10s - loss: 7.3498 - class_loss: 1.4738 - box_loss: 5876.0624 - class_acc: 0.7180 - box_acc: 0.2714 - val_loss: 7.9148 - val_class_loss: 2.1380 - val_box_loss: 5776.8075 - val_class_acc: 0.2274 - val_box_acc: 0.2553
Epoch 44/50
10s - loss: 7.3466 - class_loss: 1.4706 - box_loss: 5876.0543 - class_acc: 0.7286 - box_acc: 0.2767 - val_loss: 7.9060 - val_class_loss: 2.1277 - val_box_loss: 5778.2598 - val_class_acc: 0.2301 - val_box_acc: 0.2500
Epoch 45/50
11s - loss: 7.3456 - class_loss: 1.4696 - box_loss: 5876.0799 - class_acc: 0.7217 - box_acc: 0.2727 - val_loss: 7.8981 - val_class_loss: 2.1204 - val_box_loss: 5777.7342 - val_class_acc: 0.2394 - val_box_acc: 0.2420
Epoch 46/50
11s - loss: 7.3451 - class_loss: 1.4691 - box_loss: 5875.9383 - class_acc: 0.7217 - box_acc: 0.2734 - val_loss: 7.9001 - val_class_loss: 2.1212 - val_box_loss: 5778.8415 - val_class_acc: 0.2447 - val_box_acc: 0.2380
Epoch 47/50
10s - loss: 7.3370 - class_loss: 1.4611 - box_loss: 5875.8369 - class_acc: 0.7345 - box_acc: 0.2764 - val_loss: 7.8968 - val_class_loss: 2.1181 - val_box_loss: 5778.7160 - val_class_acc: 0.2447 - val_box_acc: 0.2434
Epoch 48/50
10s - loss: 7.3378 - class_loss: 1.4620 - box_loss: 5875.7889 - class_acc: 0.7336 - box_acc: 0.2707 - val_loss: 7.9004 - val_class_loss: 2.1219 - val_box_loss: 5778.5202 - val_class_acc: 0.2394 - val_box_acc: 0.2354
Epoch 49/50
12s - loss: 7.3326 - class_loss: 1.4568 - box_loss: 5875.7225 - class_acc: 0.7352 - box_acc: 0.2737 - val_loss: 7.8972 - val_class_loss: 2.1180 - val_box_loss: 5779.1113 - val_class_acc: 0.2487 - val_box_acc: 0.2434
Epoch 50/50
9s - loss: 7.3320 - class_loss: 1.4562 - box_loss: 5875.7083 - class_acc: 0.7349 - box_acc: 0.2707 - val_loss: 7.8993 - val_class_loss: 2.1213 - val_box_loss: 5778.0266 - val_class_acc: 0.2447 - val_box_acc: 0.2394
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[42]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&lt;keras.callbacks.history at 0x2107e4da3c8&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Wow, 91% accuracy by just adding extra, related information.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content></entry><entry><title>Red Rock Coffee Take 2</title><link href="http://notes.johnvial.info/red-rock-coffee-take-2.html" rel="alternate"></link><published>2017-06-12T00:00:00+08:00</published><updated>2017-06-12T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-12:/red-rock-coffee-take-2.html</id><summary type="html">&lt;p&gt;Here I am again at the Red Rock cafe. I really like this place. Today
I sit here researching my competitors as I wait for a few meetings
that I have lined up at this place. Meanwhile...&lt;/p&gt;
&lt;p&gt;Across the room from me two young men drink from oversized coffee cups …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Here I am again at the Red Rock cafe. I really like this place. Today
I sit here researching my competitors as I wait for a few meetings
that I have lined up at this place. Meanwhile...&lt;/p&gt;
&lt;p&gt;Across the room from me two young men drink from oversized coffee cups
(much like mine) while they duel each other in a game of Magic the
Gathering.&lt;/p&gt;
&lt;p&gt;To my right, a German (by his accent and his international power
charger), are plotting how to improve their app:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Initially we gave early users access to a tool my team, to help
them. Over time we added similar functionality for other users, and
now we have lots of tools that all do the same thing. We need to
consolidate!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I get up and go for a walk, I overhear:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I sent the investor the wrong documents!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I've now changed tables. To my right an undergraduate extols the
virtue's of MATLAB to her friend.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It's just like a really big calculator.&lt;/p&gt;
&lt;/blockquote&gt;</content></entry><entry><title>Fisheries Competition Part 1</title><link href="http://notes.johnvial.info/fisheries-part1.html" rel="alternate"></link><published>2017-06-11T00:00:00+08:00</published><updated>2017-06-11T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-06-11:/fisheries-part1.html</id><summary type="html">&lt;p&gt;A notebook as part of the homework for lesson 7 of the Fast.ai course. Here we attempt to solve the Kaggle Fisheries competition.&lt;/p&gt;</summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;keras&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.models&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.layers&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Dense&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;InputLayer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Flatten&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;MaxPooling2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GlobalMaxPool2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GlobalAveragePooling2D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.preprocessing.image&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ImageDataGenerator&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.layers.core&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Activation&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;Using TensorFlow backend.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Fisheries-Competition"&gt;Fisheries Competition&lt;a class="anchor-link" href="#Fisheries-Competition"&gt;Â¶&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;To demonstrate my understanding of the fast.ai course I'm going to try and solve the key parts of Lesson 7's fisheries challenge.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring/"&gt;https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I'm also going to use the bounding boxes that can be found:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring/discussion/25902"&gt;https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring/discussion/25902&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But the first step is to understand the data:&lt;/p&gt;
&lt;p&gt;It's setup in a nice way for keras, with the training data extracting into a set of folders, each folder containing a list of jpgs. So we can easily use the Image Data Generator from &lt;a href="https://keras.io/preprocessing/image/"&gt;https://keras.io/preprocessing/image/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;move&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;split&lt;/span&gt;
&lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;classes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[2]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['LAG', 'OTHER', '.DS_Store', 'SHARK', 'NoF', 'YFT', 'BET', 'DOL', 'ALB']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Remove any hidden folders in the listing&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;classes&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;'.'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;classes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['LAG', 'OTHER', 'SHARK', 'NoF', 'YFT', 'BET', 'DOL', 'ALB']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="We-need-to-split-data-into-train,-valid-and-sample."&gt;We need to split data into train, valid and sample.&lt;a class="anchor-link" href="#We-need-to-split-data-into-train,-valid-and-sample."&gt;Â¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.random&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;choice&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;glob&lt;/span&gt;

&lt;span class="n"&gt;valid_ratio&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.2&lt;/span&gt;
&lt;span class="n"&gt;num_sample_images&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
&lt;span class="n"&gt;valid_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;valid_path&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;valid_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;classes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;cl_valid_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;valid_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;cl_train_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;cl_sample_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_train_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'*.jpg'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_valid_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;valid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;))),&lt;/span&gt; &lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_valid_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;valid&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="c1"&gt;# We don't want the sample to contain the validation data, so redo the glob after moving. &lt;/span&gt;
        &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_train_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'*.jpg'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_sample_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;sample&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;choice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_sample_images&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cl_sample_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[5]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['LAG', 'OTHER', 'SHARK', 'NoF', 'YFT', 'BET', 'DOL', 'ALB']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;['LAG', 'OTHER', 'SHARK', 'NoF', 'YFT', 'BET', 'DOL', 'ALB']&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ImageDataGenerator&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;train_gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flow_from_directory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;valid_gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flow_from_directory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sample_gen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flow_from_directory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;bs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Found 3025 images belonging to 8 classes.
Found 752 images belonging to 8 classes.
Found 80 images belonging to 8 classes.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;bcolz&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tqdm&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;save_generator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;span class="sd"&gt;    Save the output from a generator without loading all images into memory. &lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    Does not return anything, instead writes data to disk.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    :gen: A Keras ImageDataGenerator object&lt;/span&gt;
&lt;span class="sd"&gt;    :data_dir: The folder name to store the bcolz array representing the features in. &lt;/span&gt;
&lt;span class="sd"&gt;    :labels_dir: The folder name to store the bcolz array representing the labels in.&lt;/span&gt;
&lt;span class="sd"&gt;    :mode: the write mode. Set to 'a' for append, set to 'w' to overwrite existing data and 'r' to read only. &lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    
    &lt;span class="n"&gt;num_samples&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;
    
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__next__&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__next__&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="n"&gt;trn_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;trn_label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'train'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'label'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valid'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'label'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;samp_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;samp_label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'sample'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'label'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;#save_generator(train_gen, trn_data, trn_label)&lt;/span&gt;
&lt;span class="c1"&gt;#save_generator(valid_gen, val_data, val_label)&lt;/span&gt;
&lt;span class="c1"&gt;#save_generator(sample_gen, samp_data, samp_label)&lt;/span&gt;

&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trn_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trn_label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;val_labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val_label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;(3025, 256, 256, 3)
(3025, 8)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Try-the-simplest-model-possible-to-check-data-loading,-Simple-Conv-net."&gt;Try the simplest model possible to check data loading, Simple Conv net.&lt;a class="anchor-link" href="#Try-the-simplest-model-possible-to-check-data-loading,-Simple-Conv-net."&gt;Â¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's find out the shape of the data... (actually this is the default shape due to the ImageGenerator).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;simple&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
    &lt;span class="n"&gt;InputLayer&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;MaxPooling2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;GlobalMaxPool2D&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;simple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 256, 256, 3)       0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 254, 254, 16)      448       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 63, 63, 16)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 61, 61, 16)        2320      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 59, 59, 8)         1160      
_________________________________________________________________
global_max_pooling2d_1 (Glob (None, 8)                 0         
=================================================================
Total params: 3,928.0
Trainable params: 3,928.0
Non-trainable params: 0.0
_________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;simple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'adam'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
              &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
              &lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'accuracy'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;simple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;validation_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;val_labels&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Ok,-lets-try-using-a-pretrained-inception-net."&gt;Ok, lets try using a pretrained inception net.&lt;a class="anchor-link" href="#Ok,-lets-try-using-a-pretrained-inception-net."&gt;Â¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'blah'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;keras.applications.xception&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Xception&lt;/span&gt;

&lt;span class="n"&gt;xModel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Xception&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;include_top&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;input_shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Downloading data from https://github.com/fchollet/deep-learning-models/releases/download/v0.4/xception_weights_tf_dim_ordering_tf_kernels_notop.h5
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;save_predictions&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;span class="sd"&gt;    This function will use BColz to save the predictions from a model. This is useful when you want to get the features from a&lt;/span&gt;
&lt;span class="sd"&gt;    pretrained net and build something ontop of it without re-evaluating the network every time. &lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    This function does not return anything and writes stuff to disk.&lt;/span&gt;
&lt;span class="sd"&gt;    &lt;/span&gt;
&lt;span class="sd"&gt;    :model: A keras model.&lt;/span&gt;
&lt;span class="sd"&gt;    :data: A Numpy dataframe, it is assumed that the first index is the batch index. &lt;/span&gt;
&lt;span class="sd"&gt;    :roodir: The directory to store the bcolz data&lt;/span&gt;
&lt;span class="sd"&gt;    :batchsize: The number of samples to run. Will depend upon your hardware. &lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;&lt;&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#os.makedirs(join('bdat','pretrained','data'))&lt;/span&gt;
&lt;span class="n"&gt;save_predictions&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xModel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'pretrained'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;100%|██████████| 1512/1512 [04:37&lt;00:00,  6.33it/s]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [21]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;save_predictions&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xModel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'pretrained'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valdata'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;100%|██████████| 375/375 [01:09&lt;00:00,  5.61it/s]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [22]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;xCdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'pretrained'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;xValdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'bdat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'pretrained'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'valdata'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;xCdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xModel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:],&lt;/span&gt;&lt;span class="n"&gt;verbose&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;xValdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xModel&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;val_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;verbose&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Note: When running on a cloud server like FloydHub or Crestle I found that I needed to load the data into RAM instead of using BColz. I think this is because these services are using network drives (which are much slower than SSD's). The following code loads the entire contents of the BCOLZ data into an inmemory array. If you are on an SSD you probably don't need this.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [33]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Comment out if you are reading off an SSD.&lt;/span&gt;
&lt;span class="n"&gt;xCdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xCdata&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt;
&lt;span class="n"&gt;xValdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xValdata&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [34]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pretrained_top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
    &lt;span class="n"&gt;InputLayer&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2048&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;GlobalAveragePooling2D&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
    &lt;span class="n"&gt;Dense&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'softmax'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;pretrained_top&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'adam'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'accuracy'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [35]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pretrained_top&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xCdata&lt;/span&gt;&lt;span class="p"&gt;[:],&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;validation_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xValdata&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val_labels&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Train on 3025 samples, validate on 752 samples
Epoch 1/10
3025/3025 [==============================] - 16s - loss: 4.5558 - acc: 0.3511 - val_loss: 3.2400 - val_acc: 0.4295
Epoch 2/10
3025/3025 [==============================] - 16s - loss: 2.6773 - acc: 0.4585 - val_loss: 2.2840 - val_acc: 0.5000
Epoch 3/10
3025/3025 [==============================] - 15s - loss: 1.9335 - acc: 0.5296 - val_loss: 1.8558 - val_acc: 0.5785
Epoch 4/10
3025/3025 [==============================] - 15s - loss: 1.5498 - acc: 0.6076 - val_loss: 1.5163 - val_acc: 0.5931
Epoch 5/10
3025/3025 [==============================] - 16s - loss: 1.2754 - acc: 0.6453 - val_loss: 1.2765 - val_acc: 0.6370
Epoch 6/10
3025/3025 [==============================] - 16s - loss: 1.0632 - acc: 0.6869 - val_loss: 1.2398 - val_acc: 0.6516
Epoch 7/10
3025/3025 [==============================] - 16s - loss: 0.8807 - acc: 0.7210 - val_loss: 1.0191 - val_acc: 0.6888
Epoch 8/10
3025/3025 [==============================] - 16s - loss: 0.8093 - acc: 0.7455 - val_loss: 0.9728 - val_acc: 0.6888
Epoch 9/10
3025/3025 [==============================] - 16s - loss: 0.7511 - acc: 0.7640 - val_loss: 0.9025 - val_acc: 0.7274
Epoch 10/10
3025/3025 [==============================] - 16s - loss: 0.6754 - acc: 0.7917 - val_loss: 0.8367 - val_acc: 0.7473
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[35]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&lt;keras.callbacks.history at 0x7f7bc48e5fd0&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Ok, so it looks like we've gotten 74% val accuracy with this simple model. Let's try doing a fully convolutional model.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [36]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;conv_top&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;InputLayer&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2048&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
                      &lt;span class="n"&gt;Conv2D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'same'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;activation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'relu'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                       &lt;span class="n"&gt;BatchNormalization&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                      &lt;span class="n"&gt;GlobalAveragePooling2D&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                       &lt;span class="n"&gt;Activation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'softmax'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                      &lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;conv_top&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'adam'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'accuracy'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;conv_top&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_5 (InputLayer)         (None, 8, 8, 2048)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 8, 8, 8)           147464    
_________________________________________________________________
batch_normalization_5 (Batch (None, 8, 8, 8)           32        
_________________________________________________________________
global_average_pooling2d_4 ( (None, 8)                 0         
_________________________________________________________________
activation_1 (Activation)    (None, 8)                 0         
=================================================================
Total params: 147,496
Trainable params: 147,480
Non-trainable params: 16
_________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [37]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;conv_top&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xCdata&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;validation_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xValdata&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val_labels&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Train on 3025 samples, validate on 752 samples
Epoch 1/10
3025/3025 [==============================] - 17s - loss: 1.7931 - acc: 0.4298 - val_loss: 1.2984 - val_acc: 0.5944
Epoch 2/10
3025/3025 [==============================] - 17s - loss: 1.5116 - acc: 0.6020 - val_loss: 1.2050 - val_acc: 0.6968
Epoch 3/10
3025/3025 [==============================] - 18s - loss: 1.3537 - acc: 0.7051 - val_loss: 1.1831 - val_acc: 0.7593
Epoch 4/10
3025/3025 [==============================] - 18s - loss: 1.2588 - acc: 0.7431 - val_loss: 1.2637 - val_acc: 0.7407
Epoch 5/10
3025/3025 [==============================] - 18s - loss: 1.1767 - acc: 0.7858 - val_loss: 1.0958 - val_acc: 0.7899
Epoch 6/10
3025/3025 [==============================] - 18s - loss: 1.1004 - acc: 0.8298 - val_loss: 1.0727 - val_acc: 0.7753
Epoch 7/10
3025/3025 [==============================] - 18s - loss: 1.0469 - acc: 0.8344 - val_loss: 1.0826 - val_acc: 0.7819
Epoch 8/10
3025/3025 [==============================] - 18s - loss: 0.9860 - acc: 0.8618 - val_loss: 1.1641 - val_acc: 0.8178
Epoch 9/10
3025/3025 [==============================] - 18s - loss: 0.9449 - acc: 0.8764 - val_loss: 1.0323 - val_acc: 0.8191
Epoch 10/10
3025/3025 [==============================] - 17s - loss: 0.8922 - acc: 0.8783 - val_loss: 1.1278 - val_acc: 0.8112
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt output_prompt"&gt;Out[37]:&lt;/div&gt;
&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&lt;keras.callbacks.history at 0x7f7bc5b56f60&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Cool, that got 81% validation accuracy....&lt;/p&gt;
&lt;p&gt;I couldn't get Jeremy's Keras.backend.Function to work, so I've just created a new model and predicted on it. The output is the same. 
Below I'm plotting an overlay of the average pooling layer for the predicted class&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Ok, can we visualise the parts of the pictures that are important to this conv net?&lt;/p&gt;
&lt;p&gt;Jeremy constructs a function that takes in an image and returns a pixel value... this requires an end to end model...&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [38]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;full_layers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;xModel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;conv_top&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;layers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;

&lt;span class="n"&gt;full_model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sequential&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;full_layers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;full_model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;optimizer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'adam'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loss&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;metrics&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'accuracy'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;full_model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;pred&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;full_model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newaxis&lt;/span&gt;&lt;span class="p"&gt;,:,:,:])[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;pred&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;scipy.misc&lt;/span&gt;

&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argmax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conv_top&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xCdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newaxis&lt;/span&gt;&lt;span class="p"&gt;,:,:,:]))&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;scipy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;misc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imresize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pred&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;240&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;240&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;interp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'nearest'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;
&lt;div class="output_area"&gt;
&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
xception (Model)             (None, 8, 8, 2048)        20861480  
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 8, 8, 8)           147464    
=================================================================
Total params: 21,008,944
Trainable params: 20,954,416
Non-trainable params: 54,528
_________________________________________________________________
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;It seems that the model is really using spatial cues from the image instead of actually looking for fish!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content></entry><entry><title>DSP is now a commoditiy.</title><link href="http://notes.johnvial.info/dsp-is-now-a-commoditiy.html" rel="alternate"></link><published>2017-05-30T00:00:00+08:00</published><updated>2017-05-30T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-30:/dsp-is-now-a-commoditiy.html</id><summary type="html">&lt;p&gt;Let's do another meta review of
&lt;a href="https://adexchanger.com/platforms/forrester-dsp-wave-finds-differentiation-subtle/"&gt;Adexchanger&lt;/a&gt;. This
article review a report by
&lt;a href="https://www.forrester.com/report/The+Forrester+Wave+Omnichannel+DemandSide+Platforms+Q2+2017/-/E-RES133328?utm_source=adexchanger&amp;amp;utm_medium=pr&amp;amp;utm_campaign=2017_msbg&amp;amp;utm_content=report_joyce"&gt;Forester.com&lt;/a&gt;,
since the article costs $2495 USD, I think I prefer to read
Adexchanger's article.&lt;/p&gt;
&lt;p&gt;DSP (Demand Side Platforms) are brokers that auction advertising slots
on peoples computers and phones. Apparently, this has become a
commodity …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Let's do another meta review of
&lt;a href="https://adexchanger.com/platforms/forrester-dsp-wave-finds-differentiation-subtle/"&gt;Adexchanger&lt;/a&gt;. This
article review a report by
&lt;a href="https://www.forrester.com/report/The+Forrester+Wave+Omnichannel+DemandSide+Platforms+Q2+2017/-/E-RES133328?utm_source=adexchanger&amp;amp;utm_medium=pr&amp;amp;utm_campaign=2017_msbg&amp;amp;utm_content=report_joyce"&gt;Forester.com&lt;/a&gt;,
since the article costs $2495 USD, I think I prefer to read
Adexchanger's article.&lt;/p&gt;
&lt;p&gt;DSP (Demand Side Platforms) are brokers that auction advertising slots
on peoples computers and phones. Apparently, this has become a
commodity with six platforms taking the "leader" spot, and another 3
trailing behind. Notably the main differentiator here is machine
learning and the ability to re-target people. The tag line was
"Differentiation is Subtle", which really just means that DSP's are
now a commodity.&lt;/p&gt;
&lt;p&gt;The market leaders
were:
&lt;a href="http://www.mediamath.com/"&gt;MediaMath&lt;/a&gt;,
&lt;a href="https://www.dataxu.com/"&gt;DataXu&lt;/a&gt;,
&lt;a href="https://www.thetradedesk.com/"&gt;Trade Desk&lt;/a&gt;,
&lt;a href="http://www.turn.com/"&gt;Turn&lt;/a&gt;,
&lt;a href="http://www.adobe.com/sensei.html"&gt;Adobe&lt;/a&gt; and
&lt;a href="https://rocketfuel.com/"&gt;Rocket Fuel&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“In the past it was about tools for forecasting impressions and spend,” Joyce said. “Now, it’s about the incrementality that might happen when you move $100,000 from one strategy to another strategy.”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This comment reminds me of marginal ROI, which is the idea that you try to
compare investments based on the benefit of investing the next dollar,
not the total sum.&lt;/p&gt;
&lt;h1&gt;Eric Franchi interview&lt;/h1&gt;
&lt;p&gt;However, in an adexchanger &lt;a href="https://adexchanger.com/ad-exchange-news/eric-franchi-ad-tech-vet-exit-interview/"&gt;interview&lt;/a&gt; Eric Franchi is much more optimistic.&lt;/p&gt;
&lt;p&gt;He says he is leaving ad-tech but will invest in the future of ad
tech. He is excited about the way that different markets grow:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I look at the $70 billion television market that has to become
digital. Consumers are migrating to digital. Thinking about it from
the brand lens, I start there.&lt;/p&gt;
&lt;p&gt;How can we make great brand experiences in mobile?
How can we leverage real identity to have messaging that’s relevant to the consumer?&lt;/p&gt;
&lt;p&gt;But some of the categories
I’m most excited about are areas that will be transformational –
artificial intelligence, computer vision. They’ll change digital
advertising and marketing.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I think this is a great quote!&lt;/p&gt;
&lt;p&gt;Just to keep riffing on ad-exchanger, here is a useful list
of
&lt;a href="https://adexchanger.com/agencies/little-black-book-publisher-owned-agencies/#more-112811"&gt;Ad Agencies&lt;/a&gt;. I'll
be exploring these guys as we try and get Upright Media off the
ground.&lt;/p&gt;</content></entry><entry><title>RedRock Cafe</title><link href="http://notes.johnvial.info/redrock-cafe.html" rel="alternate"></link><published>2017-05-30T00:00:00+08:00</published><updated>2017-05-30T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-30:/redrock-cafe.html</id><summary type="html">&lt;p&gt;On an unimposing corner, only 5 minutes walk from the Mountain View
Caltrain station stands the RedRock cafe. Wooden finishings and
liberal lick of red point is the theme. The coffee is good (by my
Australian standards too!) but the best thing is the conversations
that you overhear.&lt;/p&gt;
&lt;p&gt;Behind me …&lt;/p&gt;</summary><content type="html">&lt;p&gt;On an unimposing corner, only 5 minutes walk from the Mountain View
Caltrain station stands the RedRock cafe. Wooden finishings and
liberal lick of red point is the theme. The coffee is good (by my
Australian standards too!) but the best thing is the conversations
that you overhear.&lt;/p&gt;
&lt;p&gt;Behind me a young lady tries to convince her older co-founder or
possible investor that her startup is "just like Apple", and that if a
VC doesn't want to partner with them, then they probably just don't
get it.&lt;/p&gt;
&lt;p&gt;Next to me two co-founders are consoling each other to keep going:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It doesn't matter if they say that the problem may be too broad, as
 long as our assumptions are still correct there MUST be a market
 for it&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In a very out of character way, an older person is complaining about
how crap it is that his fridge is rusty. Ahh, rusty fridges, a
universal problem.&lt;/p&gt;
&lt;p&gt;An older man appears to hold a phone interview at a nearby table. But
instead of asking technical questions seems to be judging his prospective
new hire by the age of his laptop. He also dismisses Apple:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Some people think they [Apple] are innovative, and that they like to be
deliberate with their hardware, and that's why they don't always have the
latest ports. I just think they are lazy.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Suddenly, the Apple man decides to leave, citing that the cafe is not
that private. He is quickly replaced by two gents who unroll a Chess
board, and sit down with steaming tea. They speak in hushed tones as
they get ready to do battle, placing each piece down with a satisfying
knock.&lt;/p&gt;
&lt;p&gt;Suddenly my ears pick up, the lady behind me has just asked her friend:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Well, &lt;pause&gt; I need you to write me a check!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In a confident tone, the her friend replies&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ofcourse I'll write you a check.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Later in that same conversation:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Guy: It's really hard going after the consumers. You're not Apple.
Girl: But somebody has to go after the consumers! Bose, Bose just
bought it.
... see that's the problem, I care, I care about people. If I sell
the company and somebody buys it ...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Later again&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Girl: Is that REALLY true or are you just saying that to be positive?
Well, I'm glad it's happening.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;And they get up and leave the coffee shop.&lt;/p&gt;
&lt;p&gt;Random comments from another table:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;They added psuedo-random bubbles into the pipeline. I'm pretty sure
it's patented.
...
I spent most of my time fighting internal, I'm never doing that again.
...
People are gonna fight for resources...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The volume of the cafe comes and goes, with the crowd sometimes
fighting against the music, but other-times everyone seems to agree that
it's time to be quiet, and a brief lull descends upon the room.&lt;/p&gt;</content></entry><entry><title>Using BColz with Keras Generators</title><link href="http://notes.johnvial.info/using-bcolz-with-keras-generators.html" rel="alternate"></link><published>2017-05-29T00:00:00+08:00</published><updated>2017-05-29T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-29:/using-bcolz-with-keras-generators.html</id><summary type="html">&lt;p&gt;Have you ever run out of RAM when doing some Deep Learning computation
on your laptop instead of the server? One approach to solving this is
to write out the data to disk. An alternative is to write a custom
generator that reads the data. Recently I was attempting to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Have you ever run out of RAM when doing some Deep Learning computation
on your laptop instead of the server? One approach to solving this is
to write out the data to disk. An alternative is to write a custom
generator that reads the data. Recently I was attempting to implement
Lesson 7 of the &lt;a href="http://course.fast.ai"&gt;Fast.ai&lt;/a&gt; and it ran incredibly
slowly. My fix was to read the data into an on disk array, and then
read from that array
using &lt;a href="https://github.com/Blosc/bcolz"&gt;bcolz&lt;/a&gt;. Below is a function
that you can use to convert a keras generator into a bcolz array:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;bcolz&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tqdm&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;save_generator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Save the output from a generator without loading all images into memory.&lt;/span&gt;

&lt;span class="sd"&gt;    Does not return anything, instead writes data to disk.&lt;/span&gt;

&lt;span class="sd"&gt;    :gen: A Keras ImageDataGenerator object&lt;/span&gt;
&lt;span class="sd"&gt;    :data_dir: The folder name to store the bcolz array representing the features in.&lt;/span&gt;
&lt;span class="sd"&gt;    :labels_dir: The folder name to store the bcolz array representing the labels in.&lt;/span&gt;
&lt;span class="sd"&gt;    :mode: the write mode. Set to &amp;#39;a&amp;#39; for append, set to &amp;#39;w&amp;#39; to overwrite existing data and &amp;#39;r&amp;#39; to read only.&lt;/span&gt;

&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;makedirs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;num_samples&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;

    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__next__&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;labels_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_samples&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__next__&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now if you want to load the data all you have to do is (assuming
'data_dir' is the folder location):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data_dir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Another problem I encountered is that I wanted to get the predictions
from a pre-trained model and build on-top of that. However, this
required a large amount of RAM. The following function allows you to
write the results of this to disk.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;save_predictions&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    This function will use BColz to save the predictions from a model. This is useful when you want to get the features from a&lt;/span&gt;
&lt;span class="sd"&gt;    pretrained net and build something ontop of it without re-evaluating the network every time.&lt;/span&gt;

&lt;span class="sd"&gt;    This function does not return anything and writes stuff to disk.&lt;/span&gt;

&lt;span class="sd"&gt;    :model: A keras model.&lt;/span&gt;
&lt;span class="sd"&gt;    :data: A Numpy dataframe, it is assumed that the first index is the batch index.&lt;/span&gt;
&lt;span class="sd"&gt;    :roodir: The directory to store the bcolz data&lt;/span&gt;
&lt;span class="sd"&gt;    :batchsize: The number of samples to run. Will depend upon your hardware.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bcolz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;carray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rootdir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tqdm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;batch_size&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;batch_size&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content></entry><entry><title>BBDO Video Rewind</title><link href="http://notes.johnvial.info/bbdo-video-rewind.html" rel="alternate"></link><published>2017-05-12T00:00:00+08:00</published><updated>2017-05-12T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-12:/bbdo-video-rewind.html</id><summary type="html">&lt;p&gt;BBDO recently released
a
&lt;a href="https://www.slideshare.net/juliancole/bbdo-2016-video-rewind-71974433"&gt;slide deck&lt;/a&gt; of
its learnings from vertical video. This deck was then reported on
by
&lt;a href="http://www.thedrum.com/news/2017/02/09/bbdo-video-rewind-finds-need-better-mobile-optimization"&gt;thedrum.com&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Nicole Landesman, BBDO, senior communications planner, group comms
planning, said: "We saw towards the middle of 2016 that there were
more video opportunities that were coming out than ever …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;BBDO recently released
a
&lt;a href="https://www.slideshare.net/juliancole/bbdo-2016-video-rewind-71974433"&gt;slide deck&lt;/a&gt; of
its learnings from vertical video. This deck was then reported on
by
&lt;a href="http://www.thedrum.com/news/2017/02/09/bbdo-video-rewind-finds-need-better-mobile-optimization"&gt;thedrum.com&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Nicole Landesman, BBDO, senior communications planner, group comms
planning, said: "We saw towards the middle of 2016 that there were
more video opportunities that were coming out than ever before. All
of a sudden we had to think about video not just for TV and pre-roll
but there was video on all these different social platforms …
interactive video, now live is a entirely new component. We wanted
to increase our expertise around video as a whole so that BBDO could
be telling creative stories across video and they could be impactful
in any video environment.”
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Greater than 4500 were created by BBDO&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In 2016 Snapchatters watched over 10 Billion videos per day.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Many of the advertisers were buildng customer
Snapchat &lt;a href="https://support.snapchat.com/en-GB/a/lenses1"&gt;lenses&lt;/a&gt;. A
lens is a video artifact that is placed in real time over the users
face.&lt;/p&gt;
&lt;p&gt;YouTube
&lt;a href="https://www.thinkwithgoogle.com/products/youtube-trueview.html"&gt;true-views&lt;/a&gt; were
being built as well. These are the pre-roll ads that are often
skippable.&lt;/p&gt;
&lt;p&gt;BBDO Internal data suggests:
+ 90 Million people in the US watch Facebook videos.
+ 90% of Facebook users are on Mobile.
+ Only 16% of brands are optimised for mobile newsfeed.
+ 65% of viewers decide about content within the first 3 seconds.&lt;/p&gt;
&lt;p&gt;5 steps to optimizing for Facebook feed.
+ Resizing to square improved the visibility in the feed. (Note this
  was from horizontal to square, I don't think they experimented with
  vertical.
+ Make a catch title card to grab user attention in first 5 seconds.
+ Add &lt;em&gt;supers&lt;/em&gt; (large text elements) to contextualise narrative.
+ Lighten the footage to better fit in with the bright facebook feed theme.
+ Cut down length to maximise the action scenes. For this particular
  ad they had a countdown, so making sure the countdown was present
  and quick.&lt;/p&gt;
&lt;p&gt;(Currently at slide 14... )&lt;/p&gt;</content></entry><entry><title>Vertical Video PoV by Ogilvy</title><link href="http://notes.johnvial.info/vertical-video-pov-by-ogilvy.html" rel="alternate"></link><published>2017-05-12T00:00:00+08:00</published><updated>2017-05-12T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-12:/vertical-video-pov-by-ogilvy.html</id><summary type="html">&lt;p&gt;Notes from &lt;a href="https://www.slideshare.net/OgilvyWW/vertical-video-pov-61386432"&gt;POV&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Points for Vertical Video&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.zenithmedia.com/mobile-drive-19-8-increase-online-video-consumption-2016/"&gt;Zenith Optimedia&lt;/a&gt; "mobile devices will account for 58% of online watching worldwide in 2017" --&amp;gt; Although this is a press release from an ad agency.&lt;/li&gt;
&lt;li&gt;Phones are kept in portrait mode 98% of the
  time
  &lt;a href="http://www.mobilemarketer.com/cms/news/video/21146.preview"&gt;(Mobile Marketer)&lt;/a&gt; although my bing search found a dead …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Notes from &lt;a href="https://www.slideshare.net/OgilvyWW/vertical-video-pov-61386432"&gt;POV&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Points for Vertical Video&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.zenithmedia.com/mobile-drive-19-8-increase-online-video-consumption-2016/"&gt;Zenith Optimedia&lt;/a&gt; "mobile devices will account for 58% of online watching worldwide in 2017" --&amp;gt; Although this is a press release from an ad agency.&lt;/li&gt;
&lt;li&gt;Phones are kept in portrait mode 98% of the
  time
  &lt;a href="http://www.mobilemarketer.com/cms/news/video/21146.preview"&gt;(Mobile Marketer)&lt;/a&gt; although my bing search found a dead link (shown above), there are lots of other people mentioning this. &lt;a href="https://gimbal.com/vertical-mobile-video-ads/"&gt;gimbal&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;In 2015 29% of videos watched by Americans are done while the phone is vertical, compared with 5% in 2005.&lt;/em&gt; Lots of powerpoints, this one appears to be from the authors of the report &lt;a href="https://issuu.com/auvsi/docs/internet_trends_2015"&gt;Internet Trends 2015&lt;/a&gt; (Also in that same report, it found a 5x higher completion rate for vertical vs horizontal video ads). ("Ten years from now, when we look back at how this era of big data evolved ... we will be stunned at how uninformed we used to be when we make decisions." -- Bill Bosworth, DataStax CEO (2015)). (This trends report is actually quite valuable).&lt;/li&gt;
&lt;li&gt;Millennials are 2x more likely to be focused on mobile video vs computer or tv video. &lt;a href="http://go.ooyala.com/rs/OOYALA/images/Ooyala-Global-Video-Index-Q4-2014.pdf"&gt;Ooyala global video index 2014&lt;/a&gt;. Report highlights included: Tables had the best video ad completion rates, while most number of video ads served was still on PC.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Points against vertical video:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;"Limited distribution [on desktop] because few other digital video sites display from that angle making it difficult to repurpose vertical content for a horizontal screen." -- attributed to Adweek but I could not find the actual article.&lt;/li&gt;
&lt;li&gt;Black Bars when watching vertical on a horizontal player.&lt;/li&gt;
&lt;li&gt;Human Visual System is designed for side to side (Attributed to WAR C, couldn't find reference).&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Additional cost is required to make for both horizontal and vertical formats.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Mentions the term &lt;em&gt;dark post&lt;/em&gt; in context of testing vertical and horizontal videos on a market.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;People 'just don't rotate their phones' [Evan Speigel, Snapchat CEO an why advertisers that have been first to test-drive arketing on the app see a reported &lt;em&gt;NINE TIMES ENGAGEENT&lt;/em&gt; when their ads are vertically oriented']&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="http://www.adweek.com/digital/heres-how-snapchats-ceo-plans-conquer-advertising-world-165339/"&gt;GARETT SLOANE, AD WEEK&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Brand Examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;AUDI&lt;/em&gt;: an ad about AUDI's involvement in Le Mans race. Using vertical video repurposed on Snapchat. Delivered a 36% completion rate which is 80% higher than normal. (although not 9x better!). &lt;a href="http://mobilemarketingmagazine.com/audi-debuts-vertical-video-ad-format-for-le-mans/"&gt;Mobile Marketing&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;TACO BELL&lt;/em&gt;: &lt;a href="http://adage.com/article/news/snapchat-live-film-introduces-taco-bell-s-locos-taco/292629/"&gt;"Rush Order"&lt;/a&gt; ad on Snapchat achieved 74M impressiosn.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;VIACOM&lt;/em&gt;: For the MTV movie awards had some back-stage content not
  available on TV. The engagement was 12M, higher than the 9.8M who
  view the MTV broadcast. &lt;a href="http://variety.com/2015/digital/news/snapchat-viacom-in-pact-for-mtv-video-music-awards-exclusive-1201578838/"&gt;variety&lt;/a&gt; &lt;a href="http://www.latimes.com/business/technology/la-fi-tn-snapchat-viacom-20160209-story.html"&gt;la times&lt;/a&gt;. Used the &lt;em&gt;live stories&lt;/em&gt; feature:&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;A Live Story is a sequence of photos and/or videos taken of a
particular event or place that are curated by Snapchat and
transmitted to its young-skewing global platform, which can drive
tens of millions of eyeballs to that footage. Live Stories have been
produced for everything from Coachella to presidential campaign
stops, and some like “VMA” are becoming sponsored plays such as a
weekly edition featuring Major League Baseball.
- variety&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;p&gt;I think that the references and links contained in this article are
very interesting. It definitely expresses a positive point of view
about the prospects for vertical video. I'm concerned that the 98% of
the time quote source cannot be found, however, the results from the
Snapchat campaigns suggest that there is some merit to it.&lt;/p&gt;
&lt;p&gt;How easy it is to get good engagement on other advertising platforms
such as Facebook or Youtube remains to be seen.&lt;/p&gt;</content></entry><entry><title>Snapchat gets crushed</title><link href="http://notes.johnvial.info/snapchat-gets-crushed.html" rel="alternate"></link><published>2017-05-11T00:00:00+08:00</published><updated>2017-05-11T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-11:/snapchat-gets-crushed.html</id><summary type="html">&lt;p&gt;&lt;em&gt;Snapchat gets crushed&lt;/em&gt; that was the title of
the
&lt;a href="https://techcrunch.com/2017/05/10/snap-is-getting-crushed-after-falling-short-of-wall-streets-expectations/"&gt;Tech-crunch article&lt;/a&gt;. It's
main claim was that Snapchat has lost nearly all of its earnings since
it IPO'd earlier this year. Snapchat's shares are still worth $17
dollars each, I think that hardly counts as &lt;em&gt;crushed&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The article mentions that now …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;Snapchat gets crushed&lt;/em&gt; that was the title of
the
&lt;a href="https://techcrunch.com/2017/05/10/snap-is-getting-crushed-after-falling-short-of-wall-streets-expectations/"&gt;Tech-crunch article&lt;/a&gt;. It's
main claim was that Snapchat has lost nearly all of its earnings since
it IPO'd earlier this year. Snapchat's shares are still worth $17
dollars each, I think that hardly counts as &lt;em&gt;crushed&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The article mentions that now Snapchat has IPO'd, its obliged to share
it's numbers with the stock market. Given that this has been done, and
the share's haven't plummeted to the floor, we should be able to
assume that it's not all doom and gloom for Snapchat.&lt;/p&gt;
&lt;p&gt;It's fascinating to see the headline numbers for Snapchat. For
instance, it's total revenue was $149 million, and then immediately
under it there is a cost called &lt;em&gt;Cost of revenue&lt;/em&gt; $163 million. It
then goes on to have other costs, $800 Million for &lt;em&gt;research and
development&lt;/em&gt;, $200 Million for &lt;em&gt;sales and marketing&lt;/em&gt; and a ridiculous
$1.2 Billion for &lt;em&gt;General and Administrative&lt;/em&gt;. The article claims that
this last cost is due to some payouts around the IPO,
likely &lt;a href="https://en.wikipedia.org/wiki/Restricted_stock"&gt;RSU's&lt;/a&gt;. I
imagine that these costs are just the costs of doing business when you
are trying to chase big advertising companies like Facebook and
Google. Still, I find the numbers incredible, and that the cost of
revenue is larger than the revenue is the most disturbing.&lt;/p&gt;</content></entry><entry><title>Wochit Can Turn Anyone Into a Video Creator</title><link href="http://notes.johnvial.info/wochit-can-turn-anyone-into-a-video-creator.html" rel="alternate"></link><published>2017-05-11T00:00:00+08:00</published><updated>2017-05-11T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-11:/wochit-can-turn-anyone-into-a-video-creator.html</id><summary type="html">&lt;p&gt;Lets discuss this article &lt;a href="https://thevideoink.com/wochit-can-turn-anyone-into-a-video-creator-32ab23d262d5"&gt;wochit can turn anyone...&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It describes Wochit, a video editing tool that allows a self-service
approach to quickly creating user videos. Wochit is trying to be both
a video creation platform and a video creation distributor. They are
looking to assist small publishers in making better …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Lets discuss this article &lt;a href="https://thevideoink.com/wochit-can-turn-anyone-into-a-video-creator-32ab23d262d5"&gt;wochit can turn anyone...&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It describes Wochit, a video editing tool that allows a self-service
approach to quickly creating user videos. Wochit is trying to be both
a video creation platform and a video creation distributor. They are
looking to assist small publishers in making better content, and look
to gain some share of the ad revenue from videos made using their content.&lt;/p&gt;
&lt;p&gt;Given that many people are starting to get fed up with YouTube, for
instance &lt;a href="https://www.youtube.com/watch?v=7LE1tR9Qo4A"&gt;H3H3&lt;/a&gt; I wonder
if there is a space for a video editor for the masses to replace the YouTube behemoth.&lt;/p&gt;
&lt;p&gt;Wochit claims that you can create a video for a particular news item
within minutes of it happening. Allowing you to take advantage of breaking news. Their CEO Dror Ginzberg claims:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“Most of the highly-trafficked stories get most of their traffic in the first hour,” says Ginzberg. “So if you don’t have a video there, you have to monetize it with display ads.” What Wochit pitches is the ability for you, whether you’re a publisher or a brand, to get a well-produced video out there within that time frame. “If you can have a video as soon as a story goes out, that’s a great value.”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;On the Wochit &lt;a href="https://www.wochit.com/how-it-works/"&gt;how-it-works&lt;/a&gt;
page you can see their product in use. A user types in some search
queries, chooses some video sources, and the tool appears to
automatically stitch the videos together. There is also a section that
allows the user to modify the video as well. It seems that the Wochit
service is handling the licencing of this content for the user. It
also allows the aspect ratio to be changed at the click of a button.&lt;/p&gt;</content></entry><entry><title>Getting a 10x</title><link href="http://notes.johnvial.info/getting-a-10x.html" rel="alternate"></link><published>2017-05-08T00:00:00+08:00</published><updated>2017-05-08T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-08:/getting-a-10x.html</id><summary type="html">&lt;p&gt;What approach links Jeremy Howard and Elon Musk? I recently watched Elon's &lt;a href="https://www.ted.com/talks/elon_musk_the_future_we_re_building_and_boring"&gt;interview on TEDx&lt;/a&gt;, and I've also been watching Part 2 of the Fast.AI course by Jeremy Howard, in particular, &lt;a href="https://www.youtube.com/watch?v=gfhLSTkRZLI&amp;amp;feature=youtu.be"&gt;lesson 9&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Elon was talking about building a 10x solution to boring machines. He broke it down into …&lt;/p&gt;</summary><content type="html">&lt;p&gt;What approach links Jeremy Howard and Elon Musk? I recently watched Elon's &lt;a href="https://www.ted.com/talks/elon_musk_the_future_we_re_building_and_boring"&gt;interview on TEDx&lt;/a&gt;, and I've also been watching Part 2 of the Fast.AI course by Jeremy Howard, in particular, &lt;a href="https://www.youtube.com/watch?v=gfhLSTkRZLI&amp;amp;feature=youtu.be"&gt;lesson 9&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Elon was talking about building a 10x solution to boring machines. He broke it down into sub components, such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Boring at the front and reinforcing at the back can give a 2x speed up.&lt;/li&gt;
&lt;li&gt;The cost of boring is proportional to the diameter of the hole, by halving the diameter we can get a 4x cost reduction.&lt;/li&gt;
&lt;li&gt;By using the machine closer to it's thermal and energy limit we can get another 1.5x.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Elon, then multiplied these (2x4x1.5) and claimed that it was
approximately a 10x speed improvement.&lt;/p&gt;
&lt;p&gt;Jeremy also performed a similar calculation, but instead of 10x'ing a business, he was 10x'ing computation speed. Jeremy's logic was as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We can use SIMD to get a 6x speed up for computation that has been
  optimized to use the SIMD instructions.&lt;/li&gt;
&lt;li&gt;We can use Parallel processing to usally get 2-4x speed up on a standard computer.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Jeremy then claims that you can add these (6 + 4) to get a roughly 10x speed up.&lt;/p&gt;
&lt;p&gt;It's interesting that they disagree on how to combine the
improvement. However, they both follow a similar logical path. I think
that this is a good way to build up a 10x advantage where no
single technology can get you there.&lt;/p&gt;
&lt;p&gt;Also, I think that you should add you multiplicatives, not multiply them, see standard algebra.&lt;/p&gt;</content></entry><entry><title>Ad Industry Sectors</title><link href="http://notes.johnvial.info/ad-industry-sectors.html" rel="alternate"></link><published>2017-05-05T00:00:00+08:00</published><updated>2017-05-05T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-05:/ad-industry-sectors.html</id><summary type="html">&lt;p&gt;It is easy to be confused by the complexity of the advertising
industry. I am studying it so I can understand my future customers.&lt;/p&gt;
&lt;p&gt;This article will explore the high level choices that the brand
&lt;em&gt;Cowboy Binoculars&lt;/em&gt; has in advertising their product (a pair of
binoculars well suited for the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;It is easy to be confused by the complexity of the advertising
industry. I am studying it so I can understand my future customers.&lt;/p&gt;
&lt;p&gt;This article will explore the high level choices that the brand
&lt;em&gt;Cowboy Binoculars&lt;/em&gt; has in advertising their product (a pair of
binoculars well suited for the modern cowboy). Observe Cowboy Binoculars brand below:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Cowboy Binoculars" src="/images/cowboyBinoculars.png"&gt;.&lt;/p&gt;
&lt;p&gt;In
2015
&lt;a href="https://www.bloomberg.com/gadfly/articles/2015-12-08/digital-ads-on-track-to-overtake-tv-ads-by-2017"&gt;Bloomberg&lt;/a&gt; made
predictions about the future market size of advertising industry
segments in 2017, specifically that
digital ads would overtake TV ads by 2017. A recent article
by
&lt;a href="http://adage.com/article/digital/digital-ad-revenue-surpasses-tv-desktop-iab/308808/"&gt;adage.com&lt;/a&gt; observes
that this prediction has already occurred.&lt;/p&gt;
&lt;h1&gt;TV Advertising&lt;/h1&gt;
&lt;p&gt;&lt;img alt="TV" src="/images/tv.png"&gt;&lt;/p&gt;
&lt;p&gt;When I think of advertising, the form that most easily comes to mind
are advertisements on TV. TV holds a large share of the advertising
market, predicted at 37%. This market share has been on the decline, and a recent report by PWC suggests that TV is now primarily watched by sports fans (
&lt;a href="http://www.pwc.com/gx/en/industries/entertainment-media/outlook/segment-insights/tv-advertising.html"&gt;PWC TV Advertising Insights&lt;/a&gt; ).&lt;/p&gt;
&lt;h1&gt;Print Media: Newspapers and Magazines&lt;/h1&gt;
&lt;p&gt;&lt;img alt="Newspapers" src="/images/newspapers.png"&gt; &lt;img alt="Magazines" src="/images/magazines.png"&gt;&lt;/p&gt;
&lt;p&gt;A much older form of advertising is in print media. Newspapers and
Magazines are still commonplace and are an advertising channel, yet
these forms of advertising have a very small market share, with a
predicted  9% and 4% of the advertising spend respectively.&lt;/p&gt;
&lt;h1&gt;Radio&lt;/h1&gt;
&lt;p&gt;&lt;img alt="Radio" src="/images/radio.png"&gt;
Radio Ads, such as traffic reports that roll into ads, have a predicted 6% of the advertising market share.&lt;/p&gt;
&lt;h1&gt;Out of Home&lt;/h1&gt;
&lt;p&gt;&lt;img alt="outofhome" src="/images/outofhome.png"&gt;&lt;/p&gt;
&lt;p&gt;An important segment that is growing is the out of home segment
(6%). This segment has a strange name but includes billboards on the
side of buildings, digital street signs on bus stops and
advertisements on taxi's and buses. A recent report by &lt;a href="https://www.pwc.com/gx/en/industries/entertainment-media/outlook/segment-insights/out-of-home-advertising.html"&gt;PWC&lt;/a&gt; includes this category in their market segment breakdown.&lt;/p&gt;
&lt;h1&gt;Digital&lt;/h1&gt;
&lt;p&gt;&lt;img alt="Digital" src="/images/digital.png"&gt;&lt;/p&gt;
&lt;p&gt;An increasingly important market segment is the Digital Advertising market. As mentioned in the introduction, it has recently supplanted TV as the largest advertising segment, having achieved &lt;a href="http://adage.com/article/digital/digital-ad-revenue-surpasses-tv-desktop-iab/308808/"&gt;38% market share&lt;/a&gt; suggests that these predictions on market share have recently been found to be true.&lt;/p&gt;
&lt;p&gt;Digital advertising includes all ads that occur through mobie phones
or computers, such as: Product recommendations on shopping sites such
as Amazon.com, Search related advertisements appearing on Google
Search, social network feed advertisements such as Facebook feed
advertisements, banner ads and pre-roll advertisements that occur
before videos on YouTube.&lt;/p&gt;</content></entry><entry><title>Collecting Advertising Market Data</title><link href="http://notes.johnvial.info/collecting_advertising_market_data.html" rel="alternate"></link><published>2017-05-05T00:00:00+08:00</published><updated>2017-05-05T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-05:/collecting_advertising_market_data.html</id><summary type="html">&lt;p&gt;&lt;img alt="Data" src="/images/collecting_market_data.png"&gt;&lt;/p&gt;
&lt;p&gt;It's easy to find articles on the internet that predict the next
movements of any particular market. I prefer to find data and conduct
my own analysis. This list is a post of sites that I think can be
useful data sources for my future analysis. Unfortunately, some data is …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;img alt="Data" src="/images/collecting_market_data.png"&gt;&lt;/p&gt;
&lt;p&gt;It's easy to find articles on the internet that predict the next
movements of any particular market. I prefer to find data and conduct
my own analysis. This list is a post of sites that I think can be
useful data sources for my future analysis. Unfortunately, some data is behind pay walls. I hope to find free sources of data if possible.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://magnaglobal.com/magna-releases-us-advertising-forecast-march-2017/"&gt;Magna Global March Forecast&lt;/a&gt; I'm not sure what Magna is yet, but they appear to be publishing data, and for free too!&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.statista.com/statistics/272850/global-advertising-forecast/"&gt;Global Ad Expenditure (Billions)&lt;/a&gt; This site, &lt;a href="https://www.statista.com"&gt;Statista&lt;/a&gt; appears to be collecting data and sharing it for a fee.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.bloomberg.com/gadfly/articles/2015-12-08/digital-ads-on-track-to-overtake-tv-ads-by-2017"&gt;Digital Ads ontrack to overtake TV&lt;/a&gt; This site, which is the basis for my other post today, has some very cool charts on it, whose data I would love to have in a CSV.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.pwc.com/gx/en/industries/entertainment-media/outlook/segment-insights/out-of-home-advertising.html"&gt;PWC Out of home advertising&lt;/a&gt; although PWC charges for its reports, it seems to give away alot for free on this page.&lt;/li&gt;
&lt;/ul&gt;</content></entry><entry><title>Max reach, view-ability and Digital &gt; TV</title><link href="http://notes.johnvial.info/max-reach-view-ability-and-digital-tv.html" rel="alternate"></link><published>2017-05-05T00:00:00+08:00</published><updated>2017-05-05T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-05:/max-reach-view-ability-and-digital-tv.html</id><summary type="html">&lt;p&gt;&lt;img alt="Snapchat Homepage Takeover" src="/images/snapchat_takeover.png"&gt;&lt;/p&gt;
&lt;p&gt;This is a combined post, where I note about some news articles I have read.&lt;/p&gt;
&lt;h1&gt;Snapchat Home Page Takeover&lt;/h1&gt;
&lt;p&gt;The first article is: &lt;a href="http://marketingland.com/snap-ads-max-reach-snapchats-version-home-page-takeover-213644"&gt;Snapchat's home page takeover&lt;/a&gt;.
This article describes a new offering Snapchat is giving advertisers. The offering is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Snapchat’s version guarantees that a brand’s ad will …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;&lt;img alt="Snapchat Homepage Takeover" src="/images/snapchat_takeover.png"&gt;&lt;/p&gt;
&lt;p&gt;This is a combined post, where I note about some news articles I have read.&lt;/p&gt;
&lt;h1&gt;Snapchat Home Page Takeover&lt;/h1&gt;
&lt;p&gt;The first article is: &lt;a href="http://marketingland.com/snap-ads-max-reach-snapchats-version-home-page-takeover-213644"&gt;Snapchat's home page takeover&lt;/a&gt;.
This article describes a new offering Snapchat is giving advertisers. The offering is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Snapchat’s version guarantees that a brand’s ad will be served to everyone in the US who is shown a Snap Ad on a given day.
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I found this use of &lt;em&gt;takeover&lt;/em&gt; surprising, as I had previously thought
that a site &lt;em&gt;takeover&lt;/em&gt; was a bad thing. In
my &lt;a href="http://notes.johnvial.info/digital_advertising_glossary.html"&gt;glossary post&lt;/a&gt; it's described as
when a single brand own all of the ad-slots on a particular
website. From my perspective this is inefficient use of real estate,
but I think that the terms use in mobile advertising is
different. A brand may want to have massive reach, and some kind of
guarantee that &lt;em&gt;everyone&lt;/em&gt; will see an ad could be good for a
brand. It's interesting that something that could be seen as a bug,
actually is now a premium feature!&lt;/p&gt;
&lt;h1&gt;Ad metrics not really a thing&lt;/h1&gt;
&lt;p&gt;The second article is: &lt;a href="http://www.thedrum.com/news/2017/05/03/despite-widespread-mistrust-metrics-viewability-not-really-thing-video-advertising"&gt;Ad metrics not really a thing&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A key point of this article is that younger executives in advertising
companies believe &lt;em&gt;viewability&lt;/em&gt; (the tracking of whether an ad was
viewed or not), to be much more important than older advertising
executives. The article goes on to suggest this is because TV was
difficult to measure, so it is considered OK for digital video to also
have poor metrics by older executives.&lt;/p&gt;
&lt;p&gt;I must admit, I'm not sure what they mean by agency executives in this
case. Is this referring to the executives at advertising agencies,
brand's, some other organisations, or everyone?&lt;/p&gt;
&lt;p&gt;Dangerously for digital video, 60% of the under 30's felt that video
was an ineffective medium. The article briefly mentions some terms
with regard to metrics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;good audience metrics&lt;/em&gt; 56% of executives thought this was
  important. I going to assume this means a good understanding of who
  the target audience is.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;context and quality&lt;/em&gt; 62% of executives thought this was
  important. I don't understand how it is different to &lt;em&gt;good audience metrics&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;GroupM&lt;/em&gt;, &lt;em&gt;AVOC&lt;/em&gt; (audible and viewable on completion): were mentioned
  as "advanced" metrics in use for video ads. AVOC sounds self
  explanatory, but I'm not sure about GroupM.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Importantly, the survey suggests some &lt;em&gt;offers&lt;/em&gt; that are not
successfully convincing executives to invest more on-line:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;fraud-free guarantees&lt;/em&gt; A guarantee that no ad-fraud will happen?&lt;/li&gt;
&lt;li&gt;&lt;em&gt;standardised success metrics&lt;/em&gt; Perhaps the claim that metrics are
  too difficult to understand is not really true.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;premium inventory&lt;/em&gt; I guess this is the &lt;em&gt;takeover&lt;/em&gt; option Snapchat is offering above?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The survey then lists some things that would entice executives to invest more:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;pricing transparency&lt;/em&gt; I wonder how we could improve this?&lt;/li&gt;
&lt;li&gt;&lt;em&gt;inventory quality&lt;/em&gt; This is related to the earlier comments on context and quality&lt;/li&gt;
&lt;li&gt;&lt;em&gt;new formats such as vertical or 360 degree video&lt;/em&gt; Something that
  would convince 51% of executives to consider more advertising.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I think this survey was quite interesting, I'd love to see the raw
data. Apparently it was from a company named Turn, but they are not linked on the website.&lt;/p&gt;
&lt;h1&gt;Digital Advertising Surpasses TV&lt;/h1&gt;
&lt;p&gt;The third article for today is: &lt;a href="http://adage.com/article/digital/digital-ad-revenue-surpasses-tv-desktop-iab/308808/"&gt;Digital Advertising Surpasses TV&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This is actually a review of a recent IAB report, which was covered in
another article I've reviewed. So this is a review of a review!!!&lt;/p&gt;
&lt;p&gt;The key takeaway is that Digital Advertising is now bigger than TV,
with digital video alone having grown 53% in the last year to $9.1
Billion. Other important statistics were: mobile revenue grew by 145%
to $4.2 Billion, largely driven by mobile search, and that Digital
radio is supplanting terrestrial radio.&lt;/p&gt;</content></entry><entry><title>Understanding the advertising industry</title><link href="http://notes.johnvial.info/understanding_the_advertising_industry.html" rel="alternate"></link><published>2017-05-05T00:00:00+08:00</published><updated>2017-05-05T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-05:/understanding_the_advertising_industry.html</id><summary type="html">&lt;p&gt;During a discussion with my co-founder we started white-boarding the
structure of the advertising industry. It turns out that its extremely
complicated.&lt;/p&gt;
&lt;p&gt;Let's try to break it down. Here is what it looks like if you want to advertise on
general websites, blogs or mobile phone apps.&lt;/p&gt;
&lt;p&gt;&lt;img alt="High level advertising structure" src="/images/ad_network_overview.png"&gt;.&lt;/p&gt;
&lt;p&gt;That big crazy …&lt;/p&gt;</summary><content type="html">&lt;p&gt;During a discussion with my co-founder we started white-boarding the
structure of the advertising industry. It turns out that its extremely
complicated.&lt;/p&gt;
&lt;p&gt;Let's try to break it down. Here is what it looks like if you want to advertise on
general websites, blogs or mobile phone apps.&lt;/p&gt;
&lt;p&gt;&lt;img alt="High level advertising structure" src="/images/ad_network_overview.png"&gt;.&lt;/p&gt;
&lt;p&gt;That big crazy block in the middle is a network of large companies
that each play a role in the ecosystem. Each block can represent a
large company that excels at providing one component in the
ecosystem. From the perspective of our favourite brand, &lt;em&gt;Cowboy
Binoculars&lt;/em&gt;, it is quite complicated, and they will usually employ an
advertising agency to deal with it for them. The paths represent the
different companies that you can choose from, and the colours
represent many possible paths that could be taken.&lt;/p&gt;
&lt;p&gt;However, this is not &lt;em&gt;Cowboy Binoculars&lt;/em&gt; only option, they could also
choose to advertise inside one of the walled gardens of the web. In
this instance the structure looks abit more like the following diagram.&lt;/p&gt;
&lt;p&gt;&lt;img alt="High level walled garden" src="/images/walled_garden_overview.png"&gt;&lt;/p&gt;
&lt;p&gt;Here, we see that there are fewer companies to deal with, as the
walled garden owner (Face-book, Google search, etc), controls the
complete chain of ad delivery. Note that &lt;em&gt;Cowboy Binoculars&lt;/em&gt; might
still employ an ad agency, and that ad agency might use other
companies, but once the ad is made it only deals with the large walled
garden provider.&lt;/p&gt;</content></entry><entry><title>Review of 5 Digital Trends at This Years New fronts</title><link href="http://notes.johnvial.info/five_digital_trends.html" rel="alternate"></link><published>2017-05-03T16:00:00+08:00</published><updated>2017-05-03T16:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-03:/five_digital_trends.html</id><summary type="html">&lt;p&gt;Here is another interesting AdTech article, again related to the New
Fronts conference that appears to be on
soon. &lt;a href="http://www.adweek.com/tv-video/5-digital-video-trends-to-watch-for-at-this-years-newfronts/"&gt;5 Digital Video Trends to Watch for at this years NewFronts&lt;/a&gt;. My
previous article is here &lt;a href="http://notes.johnvial.info/newfronts_conference.html"&gt;New Fronts&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The article begins with a big claim:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The growth of the market for …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;Here is another interesting AdTech article, again related to the New
Fronts conference that appears to be on
soon. &lt;a href="http://www.adweek.com/tv-video/5-digital-video-trends-to-watch-for-at-this-years-newfronts/"&gt;5 Digital Video Trends to Watch for at this years NewFronts&lt;/a&gt;. My
previous article is here &lt;a href="http://notes.johnvial.info/newfronts_conference.html"&gt;New Fronts&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The article begins with a big claim:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The growth of the market for
    ad-supported digital video content—long form and short, scripted and
    reality based, animated and acted, for gamers, fashionistas and
    everyone in between—has skyrocketed, validating the importance of
    something that once seemed internally contradictory: an upfront
    marketplace for a theoretically limitless medium.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Which it then tries to back up by linking to a recent
report,
&lt;a href="https://www.iab.com/news/internet-advertising-revenue-first-time-ever-total-digital-ad-spend-hits-landmark-72-5-billion-2016/"&gt;IAB Advertising Revenue Report&lt;/a&gt;. Going
to that link you are immediately punched in the face with the reports
highlights, which serves as a market size gauge:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mobile Ad Revenue was $36.6 Billion.&lt;/li&gt;
&lt;li&gt;Mobile Video Revenue was $4.2 Billion, 145% more than last year.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The link is also very cool because it has a breakdown of the market revenue's for 2015 and 2016. Very nice!&lt;/p&gt;
&lt;p&gt;Ok, back to the 5 Digital Trends, the article has abit of fluff filler
about innovation and upstarts. It then finally delivers on the 5
digital trends we have been waiting for, although I feel more and more
like this is just a big ad for the conference.&lt;/p&gt;
&lt;p&gt;The five trends are:&lt;/p&gt;
&lt;h1&gt;Content companies becoming data-rich.&lt;/h1&gt;
&lt;p&gt;This dot point links out to the Wall Street Journal (WSJ)
link
&lt;a href="https://www.wsj.com/articles/snapchat-to-enable-ad-targeting-using-third-party-data-1484823600"&gt;Snapchat to enable ad targeting using third party data&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The WSJ article is basically just talking about Snapchat using
customer supermarket data to help them target their ads better. It
mentions that Facebook and Twitte are also doing it, and that they use
a program called DataLogix, which is owned by Oracle.&lt;/p&gt;
&lt;h1&gt;A machine behind the scenes in digital video.&lt;/h1&gt;
&lt;p&gt;This is just another point about the use of machine learning in ad
targeting. It could have been part of the previous point.&lt;/p&gt;
&lt;h1&gt;Video and social go hand in hand&lt;/h1&gt;
&lt;p&gt;This heading seems to make sense. I wonder if this is news to Ad-tech
people.  This section also references the following
article:
&lt;a href="http://www.adweek.com/digital/9-particularly-interesting-digital-marketing-stats-week-175523/"&gt;9 Particularly Interesting Marketing Stats from This Week&lt;/a&gt;.
That article also appears unremarkable, merely claiming that almost
90% of people from 20-29 use atleast one social network service.&lt;/p&gt;
&lt;h1&gt;The economics of media are driven by the limited resource of user attention.&lt;/h1&gt;
&lt;p&gt;This statement is nice, and could have alot of depth, but instead it is turned into
an advertisement for the NewFronts conference, and a place to put another adweek link.&lt;/p&gt;
&lt;h1&gt;This revolution is just getting started.&lt;/h1&gt;
&lt;p&gt;Again, simply an ad for the NewFronts conference.&lt;/p&gt;</content><category term="adtech"></category></entry><entry><title>Docker Cheat Sheet</title><link href="http://notes.johnvial.info/docker_cheat_sheet.html" rel="alternate"></link><published>2017-05-03T13:00:00+08:00</published><updated>2017-05-03T13:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-03:/docker_cheat_sheet.html</id><summary type="html">&lt;p&gt;&lt;a href="http://docker.com"&gt;Docker&lt;/a&gt; is a very useful tool for modern web development. It allows you encapsulate a computation with the operating system and associated libraries. In principle allowing you to worry less about implicit dependencies that you have on your code, as they must made clear by the docker file.&lt;/p&gt;
&lt;p&gt;This post …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://docker.com"&gt;Docker&lt;/a&gt; is a very useful tool for modern web development. It allows you encapsulate a computation with the operating system and associated libraries. In principle allowing you to worry less about implicit dependencies that you have on your code, as they must made clear by the docker file.&lt;/p&gt;
&lt;p&gt;This post is just a list of useful commands and things to know about docker.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;RUN &amp;lt;command&amp;gt;&lt;/code&gt; In a dockerfile, the RUN directive executes the &lt;code&gt;&amp;lt;command&amp;gt;&lt;/code&gt; and then creates a new layer in the dockerfile.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CMD [...]&lt;/code&gt; A CMD, this command is run whenever the docker image is run without any other commands. See &lt;a href="http://goinbigdata.com/docker-run-vs-cmd-vs-entrypoint/"&gt;RUN-vs-CMD&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker images&lt;/code&gt; will list the images currently available in Docker.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker ps&lt;/code&gt; will list the images currently running.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker exec -it &amp;lt;instance_name&amp;gt; bash&lt;/code&gt; will start a bash shell inside of the docker instance name &lt;code&gt;&amp;lt;instance_name&amp;gt;&lt;/code&gt;. Unfortunately, this is different to the image name.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker-compose up&lt;/code&gt; Assumes the presence of a docker-compose.yml file. Will run the docker container configuration described in docker-compose.yml&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker-compose -f &amp;lt;filename&amp;gt; up&lt;/code&gt; run the filename &lt;code&gt;&amp;lt;filename&amp;gt;&lt;/code&gt; instead of default.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;docker-compose up --build&lt;/code&gt; Rebulids everything described in the docker-compes.yml file.&lt;/li&gt;
&lt;/ul&gt;</content><category term="programming"></category><category term="docker"></category></entry><entry><title>NewFronts conference</title><link href="http://notes.johnvial.info/newfronts_conference.html" rel="alternate"></link><published>2017-05-02T00:00:00+08:00</published><updated>2017-05-02T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-02:/newfronts_conference.html</id><summary type="html">&lt;p&gt;Reflections on the article &lt;a href="http://www.adweek.com/tv-video/as-the-newfronts-begin-6-top-execs-discuss-videos-perils-and-promises/"&gt;As the Newronts Begin, 6 Top Execs Discuss Video's Perils and Promises&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;My co-founder Eric suggested that I should look at this article.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The digital video industry is just getting started, it's going to take atleast 10 years to play out and we don't know what's …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;Reflections on the article &lt;a href="http://www.adweek.com/tv-video/as-the-newfronts-begin-6-top-execs-discuss-videos-perils-and-promises/"&gt;As the Newronts Begin, 6 Top Execs Discuss Video's Perils and Promises&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;My co-founder Eric suggested that I should look at this article.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The digital video industry is just getting started, it's going to take atleast 10 years to play out and we don't know what's going to happen with regard to distribution.
- Jen Wong, President of Digital &amp;amp; COO, Time Inc.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So in terms of distribution I think Jen is referring to the big ad network providers such as facebook, snapchat, instagram.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It's clear that we need to get the metrics right... create better comparability and metrics around videos.
- Anna Bager, SVP/GM, Mobile and Video, IAB&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;At face value it sounds like there is alot of uncertainty about how good a particular ad product is.
I think this is a continual battle in the ad technology world.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;You've got to have premium offerings that bring people to your brand, ... there are just too many people making content out there.
Video is where you are going to build brand equity.
- Rory Brown, President Bleacher Report&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I had rarely heard the term *brand equity" before. I guess it makes sense, but I agree with Anna, it must be really hard to track.&lt;/p&gt;
&lt;p&gt;I guess this is good and bad. It's good that so many people have created so much content that now we are drowning in content. Although, when I think about the internet that I see, I'm not sure if I agree if all the content is that good.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Teaching producers to become platform and data experts. Primarily to track the results of their stories.
- David Grant, President, PopSugar Studios.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This sounds reasonable. Although, I thought that the advertising industry had already internalised the need to track their ad performance using data. I wonder what I'm missing.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Measurement [is] underdeveloped and very imprecise ... I wish advertisers would understand that it's about the lack of technology ... it's extremely difficult and actually just favors what's happening, which is a flight back to TV.
- Jen Wong&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Strange, I don't understand why advertisers would choose to go back to TV because online ads are imprecisely measured. Surely TV ads are even harder? Perhaps this is just a case of "going back to what you know". Perhaps (TV ads) also means things like Netflix? Because if it's the traditional TV media, then I can't see any of those companies being around in the next few years.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We can create an algorithm for to tell stories. We can create an algorithm for hits. That's just wrong, I think.
- Nick Shore, Chief Creative Strategist at Astronauts Wanted&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yeah, except that those algorithms don't work very well yet! Or atleast, they produce very &lt;a href="https://larseidnes.com/2015/10/13/auto-generating-clickbait-with-recurrent-neural-networks/"&gt;click-bait-y results&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;People come for the content and stay for the conversation.
- Stacy Minero, Head of planning/Creative agency at Twitter.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Cool idea.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[when hiring for producers] You have great story-telling development and creative skills and I can teach you how to appreciate data and understand the platforms
- Nick Shore&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Data science tools are being commoditized. You definately don't need a statistics degree to be able to understand data. I can see how this makes sense. I wonder though, have all the tools really been developed yet?&lt;/p&gt;
&lt;p&gt;Nick Shore mentions the &lt;em&gt;zeitgeist&lt;/em&gt;. He seems to be referring to the ever changing styles and tastes of modern people.&lt;/p&gt;
&lt;p&gt;There is abit of excitement about VR and 360 vision in this interview. Notably Wong seems to think that 360 vision (i.e. on a phone) is a more likely thing as everyone is carry phones these days. However, the panel seems unsure how to actually create VR content well, citing that linear stories are very different to &lt;em&gt;creating worlds&lt;/em&gt;. I wonder if they will just leave it to computer game manufacturers.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Brands need to think about feed first. Designing content for the feed where people are more likely to scroll or swipe than they are to stop.
- Stacy Minero&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Interesting idea. Sounds like the right track.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ROI is getting in the way. I mean it's just so bloody expensive to make video.
- Nick Shore&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Wow, Nick goes on but the main point is there. There seems to be a great tension at the moment.&lt;/p&gt;
&lt;p&gt;Rory Brown thinks that &lt;a href="https://www.comscore.com/"&gt;ComScore&lt;/a&gt; (a site that measures brand performance) is getting in the way of brands. They are just optimising to increase their comscore.&lt;/p&gt;
&lt;p&gt;Jen Wong thinks that &lt;a href="http://whatis.techtarget.com/definition/pre-roll-ad"&gt;preroll&lt;/a&gt; is a problem. I guess maybe because it sucks for everyone, as people try to skip as quickly as possible!&lt;/p&gt;</content><category term="adtech"></category></entry><entry><title>Digital Advertising Glossary</title><link href="http://notes.johnvial.info/digital_advertising_glossary.html" rel="alternate"></link><published>2017-05-01T00:00:00+08:00</published><updated>2017-05-01T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2017-05-01:/digital_advertising_glossary.html</id><summary type="html">&lt;p&gt;I'm trying to understand the advertising world, the following
link helped me. &lt;a href="http://studybreakmedia.com/glossary"&gt;Advertising Glossary&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I've typed out many of the terms to help me remember them. Perhaps it will help you as well:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Ad Tag&lt;/em&gt; Javascript that coordinates serving of ads to the user.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Ad Network&lt;/em&gt; and &lt;em&gt;Auction Price Floor …&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;I'm trying to understand the advertising world, the following
link helped me. &lt;a href="http://studybreakmedia.com/glossary"&gt;Advertising Glossary&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I've typed out many of the terms to help me remember them. Perhaps it will help you as well:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Ad Tag&lt;/em&gt; Javascript that coordinates serving of ads to the user.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Ad Network&lt;/em&gt; and &lt;em&gt;Auction Price Floor&lt;/em&gt;. I've understood that ad spots were an auction, I always thought it was one of those strange auctions that benefit the seller the most. I think it was called a &lt;a href="https://en.wikipedia.org/wiki/Dutch_auction"&gt;Dutch Auction&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Creative&lt;/em&gt; Refers to a piece of work (graphic or text) that is created, I also think it could mean a person who creates that work too.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Daisy chain (Ad Chain)&lt;/em&gt; This term seems confusing even after having read the description. The description describes arranging ads by price, but why call it a daisy chain??&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Discrepancy&lt;/em&gt; Another confusing term, I think it means the difference between the clients (viewers) and ad partners (people with ads to serve).&lt;/li&gt;
&lt;li&gt;&lt;em&gt;DSP&lt;/em&gt; Not Digital Signal Processing, but instead Demand Side Platform, apparently a marketplace to sell ad &lt;em&gt;inventory&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;IAB&lt;/em&gt; Interactive Advertising Bureau. I guess this is a &lt;a href="https://en.wikipedia.org/wiki/Peak_organisation"&gt;Peak Body&lt;/a&gt; for advertising industry.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Passback Tag&lt;/em&gt; Apparently an ad partner can choose to pass on the opportunity to serve an ad. I wonder if they still pay for the space.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Revenue Share Model&lt;/em&gt; Describes how much of the advertising revenue the publisher gets vs the ad provider. (The publisher is some website, the provider is an exchange like Google's Ad Exchange).&lt;/li&gt;
&lt;li&gt;&lt;em&gt;RTB (Real Time Bidding)&lt;/em&gt; Allows advertisers to bid on ad slots in real time.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;SSP (Supply Side Platform)&lt;/em&gt; Allows publishers to sell their websites inventory to sell.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;View-ability&lt;/em&gt; A "new" metric, will be true if 50% of ads are displayed for atleast 1 second. I wonder how much of a problem very quickly displayed ads were for this metric to be introduced.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Volume&lt;/em&gt; How many impressions or pageviews a website receives.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;CPA (Cost Per Action)&lt;/em&gt;, i.e. the customer must take an action for the advertiser to get paid.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;CPC (Cost Per Click)&lt;/em&gt; CPA where the action is a click.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;CPM (Cost Per Milli)&lt;/em&gt; Confusingly, this is per 1000 impressions, not 1e6 impressions.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;eCPM (effective CPM)&lt;/em&gt; Tries to compensate for impressions that we're actually shown or paid.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;rCPM (real CPM)&lt;/em&gt; A metric that takes into account the impressions that occurred. Apparently not all impressions are paid??&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ATF (Above The Fold)&lt;/em&gt;, i.e. the first part of the website.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Ad Units&lt;/em&gt; The space where an ad is displayed.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Banner/Leader board, Rectangle, Tower/Skyscraper&lt;/em&gt; Terms to describe the shape of the ad unit.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;BTF (Below The Fold)&lt;/em&gt; Opposite of ATF.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Native ads&lt;/em&gt; Advertising that blends into the user experience.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Rich Media&lt;/em&gt; Apparently this is richer advertising, I'm not sure I've encountered these before.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Rising Stars&lt;/em&gt; A "more standardised" version of Rich Media.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Site Skin&lt;/em&gt; Creative that appears behind the main content of the page. I think I've seen &lt;a href="http://www.ebay.com"&gt;e-bay&lt;/a&gt; do that before.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Ad Impression&lt;/em&gt; A single ad view, can be purchased.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Bounce Rate&lt;/em&gt; The percentage of users that click an ad but immediately leave the linked site.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Pageview&lt;/em&gt; whenever a user loads a page, a pageview occurs.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Re-Targeting pixel&lt;/em&gt; A unique identifier that tracks user behaviour allowing targeted ads. It's weird that this is called a pixel.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Visitor&lt;/em&gt; Total count of users visiting a site. Includes multiple visits by the same person.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Cachebuster&lt;/em&gt; To avoid the browser caching an old ad, the source code is modified by adding a unique number for each site visit, to "bust the cache" so that the new ad is actually served.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;DMA (Designated Market Area)&lt;/em&gt; The actual geographic region that an advertiser wants to advertise in.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Flight&lt;/em&gt; How long the ads will run for, a time measurement.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Frequency Cap&lt;/em&gt; The max number of times an ad can be shown to a unique user.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Geo-targeting&lt;/em&gt; Seems similar to DMA.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Invocation code&lt;/em&gt; I think this may be synonymous with Ad Tag. Refers to the code placed on a website that "summons" an ad.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Line Item&lt;/em&gt; A single unit of advertising.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Order&lt;/em&gt; A group of line items.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Roadblock (Takeover)&lt;/em&gt; When an advertiser takes over ever available ad spot on a page, this is called a RoadBlock or Takeover.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;ROS (Run of Site)&lt;/em&gt; Not sure about this definition. Seems to mean that you indicate a site to have your ads run on (such as google.com).&lt;/li&gt;
&lt;li&gt;&lt;em&gt;SOV (Share of Voice)&lt;/em&gt; The percentage of a particular advertisers inventory that an advertiser owns during a campaign.&lt;/li&gt;
&lt;/ul&gt;</content><category term="adtech"></category></entry><entry><title>Doing Haskel Tutorial</title><link href="http://notes.johnvial.info/haskell.html" rel="alternate"></link><published>2015-04-22T00:00:00+08:00</published><updated>2015-04-22T00:00:00+08:00</updated><author><name>John Vial</name></author><id>tag:notes.johnvial.info,2015-04-22:/haskell.html</id><summary type="html">&lt;p&gt;Just some from the first chapter of the online version of &lt;a href="http://learnyouahaskell.com/"&gt;Learn you a Haskell&lt;/a&gt;.&lt;/p&gt;
&lt;h1&gt;1 Starting Out&lt;/h1&gt;
&lt;p&gt;&lt;a href="http://learnyouahaskell.com/starting-out"&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;make prompt prettier using &lt;code&gt;:set prompt "ghci&amp;gt; "&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;50 * -1&lt;/code&gt; is an error, must do `50 * (-1)'. It seems to me that this is something to do with how whatever Haskell equivalent …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;Just some from the first chapter of the online version of &lt;a href="http://learnyouahaskell.com/"&gt;Learn you a Haskell&lt;/a&gt;.&lt;/p&gt;
&lt;h1&gt;1 Starting Out&lt;/h1&gt;
&lt;p&gt;&lt;a href="http://learnyouahaskell.com/starting-out"&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;make prompt prettier using &lt;code&gt;:set prompt "ghci&amp;gt; "&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;50 * -1&lt;/code&gt; is an error, must do `50 * (-1)'. It seems to me that this is something to do with how whatever Haskell equivalent of operators is.&lt;/li&gt;
&lt;li&gt;ok, so * is a function, whose arguments are but between it, its an &lt;em&gt;infix&lt;/em&gt; function.&lt;/li&gt;
&lt;li&gt;functions are called by writing name, space, arguments&lt;/li&gt;
&lt;li&gt;parentheses are only used to group expressions into an argument.&lt;/li&gt;
&lt;li&gt;an &lt;code&gt;=&lt;/code&gt; is used to define functions.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:l&lt;/code&gt; for load to load a &lt;code&gt;.hs&lt;/code&gt; file.&lt;/li&gt;
&lt;li&gt;function names cannot begin with capital letters, the character `` is ok in a function name.&lt;/li&gt;
&lt;li&gt;to define a list, use the keyword &lt;code&gt;let&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;index a list usin &lt;code&gt;!!&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;add to end of list with &lt;code&gt;++&lt;/code&gt; add to begining with &lt;code&gt;:&lt;/code&gt;, note that adding to end is slow.&lt;/li&gt;
&lt;li&gt;ranges done using the &lt;code&gt;..&lt;/code&gt;, i.e. &lt;code&gt;[1..20]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;tuples are defined using parentheses, however they are of fixed size but can contain mixed types.&lt;/li&gt;
&lt;li&gt;list comprehensions are awesome. The &lt;code&gt;|&lt;/code&gt; defines the predicates and domains , the &lt;code&gt;&amp;lt;-&lt;/code&gt; assigns sets to a variable, and commas separate the conditions.&lt;/li&gt;
&lt;/ul&gt;</content><category term="programming"></category></entry></feed>